(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{15323:function(e,t,n){"use strict";n.r(t),n.d(t,{Graph:function(){return xr},GraphPage:function(){return pr},default:function(){return fr}});var r=n(30266),o=n(83789),i=n(92809),l=n(80318),s=n(809),c=n.n(s),a=n(97375),d=n(68527),u=n(47398),h=n(68921),g=n(105),f=n(27549),p=n(74376),x=n(52596),j=n(9008),v=n(67294),b=n(32802),m=n.n(b),y=n(47516),C=n(63750),w=n(22003),k=n(31122),O=n(7520),S=n(36194),I=[],N={};for(var P in S.oY)for(var B in S.oY[P]){var D=P+B;"LinearNone"===D&&(D="Linear"),I.push(D),N[D]=S.oY[P][B]}var L=N,F={enabled:!0,charge:-700,collision:!0,collisionStrength:20,centering:!0,centeringStrength:.2,linkStrength:.3,linkIts:1,alphaDecay:.05,alphaTarget:0,alphaMin:0,velocityDecay:.25,gravity:.3,gravityOn:!0,gravityLocal:!1},T={orphans:!1,dailies:!1,parent:"heading",filelessCites:!1,tagsBlacklist:[],tagsWhitelist:[],linktagsBlacklist:[],linktagsWhitelist:[],dirsBlocklist:[],dirsAllowlist:[],bad:!0,nodes:[],links:[],date:[],noter:!0},z={method:"degree"},E={particles:!1,particlesNumber:0,particlesWidth:4,arrows:!1,arrowsLength:1,arrowsPos:.5,arrowsColor:"",linkOpacity:.8,linkWidth:1,nodeRel:3,nodeOpacity:1,nodeResolution:12,labels:2,labelScale:1.5,labelFontSize:10,labelLength:40,labelWordWrap:25,labelLineSpace:1,labelDynamicDegree:8,labelDynamicStrength:.5,highlight:!0,highlightNodeSize:1.1,highlightLinkSize:.7,highlightFade:.8,highlightAnim:!0,animationSpeed:360,algorithmOptions:I,algorithmName:"CircularOut",linkColorScheme:"gray.500",nodeColorScheme:["red.500","gray.600","yellow.500","green.500","cyan.500","blue.500","pink.500","purple.500","orange.500"],nodeHighlight:"purple.500",linkHighlight:"purple.500",backgroundColor:"white",emacsNodeColor:"gray.800",labelTextColor:"black",labelBackgroundColor:"",labelBackgroundOpacity:.7,citeDashes:!0,citeDashLength:35,citeGapLength:15,citeLinkColor:"gray.700",citeLinkHighlightColor:"",citeNodeColor:"black",refDashes:!0,refDashLength:35,refGapLength:15,refLinkColor:"gray.700",refLinkHighlightColor:"",refNodeColor:"black",nodeSizeLinks:.5,nodeZoomSize:1.2},R={follow:"zoom",localSame:"add",zoomPadding:200,zoomSpeed:2e3},Z={highlight:"hover",local:"double",follow:"never",context:"right",preview:"click",backgroundExitsLocal:!1},H={neighbors:1},W=["red.500","orange.500","yellow.500","green.500","cyan.500","blue.500","pink.500","purple.500","white","gray.100","gray.200","gray.300","gray.400","gray.500","gray.600","gray.700","gray.800","gray.900","black"],A=n(57324),M=n(90232),V=n(52072);function _(e,t,n){n.send(JSON.stringify({command:e,data:t}))}function U(e,t){_("open",{id:e.id},t)}var q=n(10219),X=n(44592),Q=n(38554),G=n.n(Q),K=n(53869),$=n(99860);function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ee={ease:[.25,.1,.25,1],easeIn:[.4,0,1,1],easeOut:[0,0,.2,1],easeInOut:[.4,0,.2,1]};var te=function(e,t){return Y(Y({},e),{},{delay:(0,X.hj)(t)?t:null===t||void 0===t?void 0:t.enter})},ne=function(e,t){return Y(Y({},e),{},{delay:(0,X.hj)(t)?t:null===t||void 0===t?void 0:t.exit})},re=n(85893),oe=["in","unmountOnExit","animateOpacity","startingSize","endingSize","dimension","style","className","transition","transitionEnd"];function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var se=function(e){return null!=e&&parseInt(e.toString(),10)>0},ce={exit:{size:{duration:.2,ease:ee.ease},opacity:{duration:.3,ease:ee.ease}},enter:{size:{duration:.3,ease:ee.ease},opacity:{duration:.4,ease:ee.ease}}},ae={exit:function(e){var t,n,r=e.animateOpacity,o=e.startingSize,l=e.transition,s=e.transitionEnd,c=e.delay,a=e.dimension;return le(le({},r&&{opacity:se(o)?1:0}),{},(n={overflow:"hidden"},(0,i.Z)(n,a,o),(0,i.Z)(n,"transitionEnd",null===s||void 0===s?void 0:s.exit),(0,i.Z)(n,"transition",null!==(t=null===l||void 0===l?void 0:l.exit)&&void 0!==t?t:ne(ce.exit,c)),n))},enter:function(e){var t,n,r=e.animateOpacity,o=e.endingSize,l=e.transition,s=e.transitionEnd,c=e.delay,a=e.dimension;return le(le({},r&&{opacity:1}),{},(n={},(0,i.Z)(n,a,o),(0,i.Z)(n,"transitionEnd",null===s||void 0===s?void 0:s.enter),(0,i.Z)(n,"transition",null!==(t=null===l||void 0===l?void 0:l.enter)&&void 0!==t?t:te(ce.enter,c)),n))}},de=v.forwardRef((function(e,t){var n=e.in,r=e.unmountOnExit,o=e.animateOpacity,i=void 0===o||o,s=e.startingSize,c=void 0===s?0:s,a=e.endingSize,d=void 0===a?"auto":a,u=e.dimension,h=void 0===u?"height":u,g=e.style,f=e.className,p=e.transition,x=e.transitionEnd,j=(0,q.Z)(e,oe),b=v.useState(!1),m=(0,l.Z)(b,2),y=m[0],C=m[1];v.useEffect((function(){var e=setTimeout((function(){C(!0)}));return function(){return clearTimeout(e)}}),[]),(0,X.ZK)({condition:Boolean(c>0&&r),message:"startingSize and unmountOnExit are mutually exclusive. You can't use them together"});var w=parseFloat(c.toString())>0,k={startingSize:c,endingSize:d,animateOpacity:i,dimension:h,transition:y?p:{enter:{duration:0}},transitionEnd:G()(x,{enter:{overflow:"initial"},exit:r?void 0:{display:w?"block":"none"}})},O=!r||n,S=n||r?"enter":"exit";return(0,re.jsx)(K.M,{initial:!1,custom:k,children:O&&(0,re.jsx)($.E.div,le(le({ref:t},j),{},{className:(0,X.cx)("chakra-collapse",f),style:le({overflow:"hidden",display:"block"},g),custom:k,variants:ae,initial:!!r&&"exit",animate:S,exit:"exit"}))})}));function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function he(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}X.Ts&&(de.displayName="Collapse");var ge=function(e){var t=e.setTagColors,n=e.setFilter,r=e.filter,l=e.tagColors,s=e.target,c=r.tagsBlacklist,u=r.tagsWhitelist,h=c.indexOf(s)>-1,g=u.indexOf(s)>-1,f=(0,a.qY)();return(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(A.sN,{icon:(0,re.jsx)(d.Box,{bgColor:l[s],borderRadius:"sm",height:3,width:3,borderColor:l[s]||"gray.600",borderWidth:1}),closeOnSelect:!1,onClick:f.onToggle,children:(0,re.jsx)(d.Text,{children:"Change color"})}),(0,re.jsx)(de,{in:f.isOpen,children:(0,re.jsxs)(d.Flex,{ml:2,mt:2,flexWrap:"wrap",children:[(0,re.jsx)(d.Box,{children:(0,re.jsx)(d.Box,{tabIndex:0,cursor:"pointer",onClick:function(){return t((function(e){return Object.fromEntries(Object.keys(e).filter((function(e){return e!==s})).map((function(t){return[t,e[t]]})))}))},bgColor:"",m:1,borderRadius:"sm",borderColor:"gray.600",borderWidth:1,height:3,width:3})},"empty"),W.map((function(e){return(0,re.jsx)(d.Box,{children:(0,re.jsx)(d.Box,{tabIndex:0,cursor:"pointer",onClick:function(){return t(he(he({},l),{},(0,i.Z)({},s,e)))},bgColor:e,m:1,borderRadius:"sm",height:3,width:3})},e)}))]})}),!g&&(0,re.jsx)(A.sN,{onClick:function(){n(h?function(e){return he(he({},e),{},{tagsBlacklist:e.tagsBlacklist.filter((function(e){return e!==s}))})}:function(e){return he(he({},e),{},{tagsBlacklist:[].concat((0,o.Z)(e.tagsBlacklist),[s])})})},icon:h?(0,re.jsx)(V.MinusIcon,{}):(0,re.jsx)(V.ViewOffIcon,{}),children:h?"Remove from blocklist":"Add to blocklist"}),!h&&(0,re.jsx)(A.sN,{onClick:function(){n(g?function(e){return he(he({},e),{},{tagsWhitelist:e.tagsWhitelist.filter((function(e){return e!==s}))})}:function(e){return he(he({},e),{},{tagsWhitelist:[].concat((0,o.Z)(e.tagsWhitelist),[s])})})},icon:g?(0,re.jsx)(V.MinusIcon,{}):(0,re.jsx)(V.ViewIcon,{}),children:g?"Remove from allowlist":"Add to allowlist"})]})},fe=function(e){e.background;var t,n,r=e.target,o=(e.nodeType,e.coordinates),i=e.handleLocal,l=e.menuClose,s=e.scope,c=e.webSocket,u=e.setPreviewNode,g=e.setTagColors,f=e.tagColors,p=e.setFilter,x=e.filter,j=(0,a.qY)(),b=j.isOpen,m=j.onOpen,C=j.onClose;(0,v.useRef)();return(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(A.v2,{defaultIsOpen:!0,closeOnBlur:!1,onClose:function(){return l()},children:(0,re.jsx)(A.qy,{zIndex:"overlay",bgColor:"white",color:"black",position:"absolute",left:o.left,top:o.top,right:o.right,bottom:o.bottom,fontSize:"xs",boxShadow:"xl",children:"string"!==typeof r?(0,re.jsxs)(re.Fragment,{children:[r&&(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(d.Heading,{size:"xs",isTruncated:!0,px:3,py:1,children:r.title}),(0,re.jsx)(A.R,{borderColor:"gray.500"})]}),0!==s.nodeIds.length&&(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(A.sN,{onClick:function(){return i(r,"add")},icon:(0,re.jsx)(V.PlusSquareIcon,{}),children:"Expand local graph at node"}),(0,re.jsx)(A.sN,{onClick:function(){return i(r,"replace")},icon:(0,re.jsx)(y.DvO,{}),children:"Open local graph for this node"}),(0,re.jsx)(A.sN,{onClick:function(){return i(r,"remove")},icon:(0,re.jsx)(V.MinusIcon,{}),children:"Exclude node from local graph"})]}),null!==r&&void 0!==r&&null!==(t=r.properties)&&void 0!==t&&t.FILELESS?(0,re.jsx)(A.sN,{icon:(0,re.jsx)(V.AddIcon,{}),onClick:function(){return function(e,t){_("create",{id:e.id,title:e.title,ref:e.properties.ROAM_REFS},t)}(r,c)},children:"Create node"}):(0,re.jsx)(A.sN,{icon:(0,re.jsx)(V.EditIcon,{}),onClick:function(){return U(r,c)},children:"Open in Emacs"}),(null===r||void 0===r||null===(n=r.properties)||void 0===n?void 0:n.ROAM_REFS)&&(0,re.jsx)(A.sN,{icon:(0,re.jsx)(V.ExternalLinkIcon,{}),children:"Open in Zotero"}),0===s.nodeIds.length&&(0,re.jsx)(A.sN,{icon:(0,re.jsx)(y.DvO,{}),onClick:function(){return i(r,"replace")},children:"Open local graph"}),(0,re.jsx)(A.sN,{icon:(0,re.jsx)(V.ViewIcon,{}),onClick:function(){u(r)},children:"Preview"}),0===(null===r||void 0===r?void 0:r.level)&&(0,re.jsx)(A.sN,{closeOnSelect:!1,icon:(0,re.jsx)(V.DeleteIcon,{color:"red.500"}),color:"red.500",onClick:m,children:"Permanently delete note"})]}):(0,re.jsx)(ge,{target:r,tagColors:f,filter:x,setTagColors:g,setFilter:p})})}),"string"!==typeof r&&(0,re.jsxs)(M.u_,{isCentered:!0,isOpen:b,onClose:C,children:[(0,re.jsx)(M.ZA,{}),(0,re.jsxs)(M.hz,{zIndex:"popover",children:[(0,re.jsx)(M.xB,{children:"Delete node?"}),(0,re.jsx)(M.ol,{}),(0,re.jsx)(M.fe,{children:(0,re.jsxs)(d.VStack,{spacing:4,display:"flex",alignItems:"flex-start",children:[(0,re.jsx)(d.Text,{children:"This will permanently delete your note:"}),(0,re.jsx)(d.Text,{fontWeight:"bold",children:null===r||void 0===r?void 0:r.title}),0!==(null===r||void 0===r?void 0:r.level)&&(0,re.jsx)(d.Text,{children:"This will only delete the from this heading until but not including the next node. Your parent file and all other nodes will not be deleted."}),(0,re.jsx)(d.Text,{children:"Are you sure you want to do continue?"})]})}),(0,re.jsxs)(M.mz,{children:[(0,re.jsx)(h.Button,{mr:3,onClick:function(){console.log("closing"),C(),l()},children:"Cancel"}),(0,re.jsx)(h.Button,{variant:"link",colorScheme:"red",ml:3,onClick:function(){console.log("aaaaa"),function(e,t){0===e.level&&_("delete",{id:e.id,file:e.file},t)}(r,c),C(),l()},children:"Delete node"})]})]})]})]})},pe=n(5434),xe=n(51649),je=function(e){var t=e.setJustification,n=(e.setIndent,e.setFont,e.justification),r=(e.setPreviewNode,e.canUndo),o=e.canRedo,i=(e.resetPreviewNode,e.previousPreviewNode),l=e.nextPreviewNode,s=e.outline,c=e.setOutline,a=e.collapse,g=e.setCollapse;return(0,re.jsxs)(d.Flex,{flex:"0 1 40px",pb:3,alignItems:"center",justifyContent:"space-between",pr:1,children:[(0,re.jsx)(d.Flex,{children:(0,re.jsxs)(h.ButtonGroup,{isAttached:!0,children:[(0,re.jsx)(u.u,{label:"Go backward",children:(0,re.jsx)(h.IconButton,{_focus:{},variant:"subtle",icon:(0,re.jsx)(V.ChevronLeftIcon,{}),"aria-label":"Previous node",disabled:!r,onClick:function(){return i()}})}),(0,re.jsx)(u.u,{label:"Go forward",children:(0,re.jsx)(h.IconButton,{_focus:{},variant:"subtle",icon:(0,re.jsx)(V.ChevronRightIcon,{}),"aria-label":"Next node",disabled:!o,onClick:function(){return l()}})})]})}),(0,re.jsxs)(d.Flex,{children:[(0,re.jsx)(u.u,{label:"Justify content",children:(0,re.jsx)(h.IconButton,{variant:"subtle","aria-label":"Justify content",icon:[(0,re.jsx)(y.v9V,{},"justify"),(0,re.jsx)(y.YSr,{},"left"),(0,re.jsx)(y.RXA,{},"right"),(0,re.jsx)(y.tr_,{},"center")][n],onClick:function(){return t((function(e){return(e+1)%4}))}})}),(0,re.jsx)(u.u,{label:"Toggle outline view",children:(0,re.jsx)(h.IconButton,{variant:"subtle","aria-label":"Justify content",icon:s?(0,re.jsx)(xe.XQM,{}):(0,re.jsx)(xe.JfF,{}),onClick:function(){return c((function(e){return!e}))}})}),(0,re.jsx)(u.u,{label:"Toggle headers",children:(0,re.jsx)(h.IconButton,{variant:"subtle","aria-label":"Toggle headers",icon:a?(0,re.jsx)(pe.omV,{}):(0,re.jsx)(pe.egf,{}),onClick:function(){return g((function(e){return!e}))}})})]})]})},ve=n(96356);function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ye=function(e){var t,n,r,i=e.filter,l=e.setFilter,s=e.tagColors,c=(e.setTagColors,e.openContextMenu),a=e.previewNode;return null!==a&&void 0!==a&&a.tags&&null!==(null===a||void 0===a||null===(t=a.tags)||void 0===t?void 0:t[0])?(0,re.jsx)(d.Flex,{mb:2,flexWrap:"wrap",children:null===a||void 0===a||null===(n=a.tags)||void 0===n||null===(r=n.map)||void 0===r?void 0:r.call(n,(function(e){var t,n,r,a=null!==(t=i.tagsBlacklist)&&void 0!==t?t:[],d=null!==(n=i.tagsWhitelist)&&void 0!==n?n:[],u=a.includes(e),h=d.includes(e);return(0,re.jsxs)(ve.Tag,{tabIndex:0,mr:2,mt:2,onContextMenu:function(t){t.preventDefault(),c(e,t)},cursor:"pointer",onClick:function(){l(u?function(t){return me(me({},t),{},{tagsBlacklist:t.tagsBlacklist.filter((function(t){return t!==e})),tagsWhitelist:[].concat((0,o.Z)(t.tagsWhitelist),[e])})}:h?function(t){return me(me({},t),{},{tagsWhitelist:t.tagsWhitelist.filter((function(t){return t!==e}))})}:function(t){return me(me({},t),{},{tagsBlacklist:[].concat((0,o.Z)(t.tagsBlacklist),[e])})})},size:"sm",variant:"outline",colorScheme:(null===(r=s[e])||void 0===r?void 0:r.replaceAll(/(.*?)\..*/g,"$1"))||void 0,children:[(0,re.jsx)(ve.TagLabel,{children:e}),u?(0,re.jsx)(ve.TagRightIcon,{as:V.ViewOffIcon}):h?(0,re.jsx)(ve.TagRightIcon,{as:V.ViewIcon}):null]},e)}))}):null},Ce=n(18835),we=n.n(Ce),ke=n(13816),Oe=n.n(ke),Se=n(42728),Ie=n.n(Se),Ne=n(77890),Pe=n.n(Ne),Be=n(94986),De=n.n(Be),Le=n(88541),Fe=n.n(Le),Te=n(71167),ze=n.n(Te),Ee=(n(85062),n(27431)),Re=n.n(Ee),Ze=n(12861),He=n.n(Ze),We=n(10043),Ae=n.n(We),Me=n(80816),Ve=n(93545),_e=n.n(Ve),Ue=n(15941),qe=n.n(Ue),Xe=n(67597),Qe=n.n(Xe),Ge=n(44549),Ke=n.n(Ge),$e=n(78818),Je=n.n($e),Ye=(0,v.createContext)({layout:[],setLayout:null}),et=n(32095),tt=n(46871),nt=n(29356),rt={".headingFlex":{flexDirection:"row-reverse",justifyContent:"flex-end"},".outlineHeadingButton":{display:"none"},h1:{color:"black",lineHeight:"1.2",fontSize:"16",fontWeight:"bold",paddingTop:2},h2:{fontSize:"14",color:"black",fontWeight:"bold",fontStyle:"bold italic",paddingTop:2},h3:{fontSize:"13",color:"black",paddingTop:2},h4:{fontSize:"12",fontStyle:"italic",color:"black",paddingTop:2},".sectionContent":{paddingTop:2}},ot={".headingFlex":{flexDirection:"row",justifyContent:"flex-start"},".viewerHeadingButton":{display:"none"},".sectionContent":{mt:3,paddingLeft:4,ml:"11px",borderLeftWidth:"1px",borderLeftColor:"gray.500"},".preHeadingContent":{},"h1,h2,h3,h4,h5,h6,h7,h8":{pl:1,lineHeight:"1.25",color:"black",fontSize:15,fontWeight:700},".sec":{pt:1},".wrapClass > div > p":{mb:2},p:{fontWeight:500,fontSize:14,pb:2}},it={".katex":{overflowX:"scroll"},ol:{paddingLeft:4,py:1},"li::marker":{fontSize:12,fontWeight:"bold"},li:{pt:1},ul:{paddingLeft:"5"},p:{fontSize:"14",fontWeight:"500 !important",pb:2},div:{hyphens:"auto !important"},".title":{textAlign:"center",marginBottom:".2em"},".subtitle":{textAlign:"center",fontSize:"medium",fontWeight:"bold",marginTop:0},".TODO":{color:"red.500"},".equationContainer":{display:"table",textAlign:"center",width:"100%"},".equation":{verticalAlign:"middle"},".equation-label":{display:"tableCell",textAlign:"right",verticalAlign:"middle"},".inlinetask":{padding:"10px",border:"2px solid gray",margin:"10px",background:"#ffffcc"},"#org-div-home-and-up":{textAlign:"right",fontSize:"70 % ",whiteSpace:"nowrap"},textarea:{overflowX:"auto"},".linenr":{fontSize:"smaller"},".org-info-js_info-navigation":{borderStyle:"none"},"#org-info-js_console-label":{fontSize:"10px",fontWeight:"bold",whiteSpace:"nowrap"},".org-info-js_search-highlight":{backgroundColor:"#ffff00",color:"#000000",fontWeight:"bold"},".org-svg":{width:"90%"},".DONE":{color:"green"},".priority":{fontFamily:"monospace",color:"orange"},".tag":{backgroundColor:"white",fontFamily:"monospace",padding:"2px",fontSize:"80%",fontWeight:"normal"},".timestamp":{color:"#bebebe"},".timestamp-kwd":{color:"#5f9ea0"},".org-right":{marginLeft:"auto",marginRight:"0px",textAlign:"right"},".org-left":{marginLeft:"0px",marginRight:"auto",textAlign:"left"},".org-center":{marginLeft:"auto",marginRight:"auto",textAlign:"center"},".underline":{textDecoration:"underline"},"#postamble p":{fontSize:"90%",margin:".2em"},"#preamble p":{fontSize:"90%",margin:".2em"},"p.verse":{marginLeft:"3%"},pre:{borderRadius:"3px",backgroundColor:"white",padding:"8pt",fontFamily:"monospace",overflow:"auto",margin:"1.2em"},"pre.src":{position:"relative",overflow:"auto"},"pre.src:before":{display:"none",position:"absolute",top:"-8px",right:"12px",padding:"3px",backgroundColor:"white"},"caption.t-above":{captionSide:"top"},"caption.t-bottom":{captionSide:"bottom"},"th.org-right":{textAlign:"center"},"th.org-left":{textAlign:"center"},"th.org-center":{textAlign:"center"},"td.org-right":{textAlign:"right"},"td.org-left":{textAlign:"left"},"td.org-center":{textAlign:"center"},".footpara":{display:"inline"},".footdef":{marginBottom:"1em"},".figure":{padding:"1em"},".figure p":{textAlign:"center"},".math.math-display .katex":{overflow:"auto",minHeight:"1.5em"}},lt=n(86658),st=function(e,t){return e.split(".").reduce((function(e,t){return e[t]}),t.colors)},ct=["style"];function at(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?at(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):at(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ut=function(e){var t=e.noUnderline,n=e.id,r=e.setSidebarHighlightedNode,o=(e.setPreviewNode,e.onClickFunction),i=e.nodeById,l=e.openContextMenu,s=e.href,c=e.children,a=e.isWiki,u=(0,v.useContext)(nt.N).highlightColor,h=(0,g.Fg)(),f=st(u,h),p=(s.replaceAll(/(.*?)\:?.*/g,"$1"),s.replaceAll(/.*?\:(.*)/g,"$1")),x=null!==n&&void 0!==n?n:p,j=a?"[[".concat(c,"]]"):c;return(0,re.jsx)(d.Text,{as:"a",onMouseEnter:function(){return r(i[x])},onMouseLeave:function(){return r({})},tabIndex:0,display:"inline",overflow:"hidden",fontWeight:500,color:u,textDecoration:t?void 0:"underline",onContextMenu:function(e){e.preventDefault(),l(i[p],e)},onClick:function(){return o(p)},_hover:{textDecoration:"none",cursor:"pointer",bgColor:f+"22"},_focus:{outlineColor:u},children:j})},ht=function(e){var t=e.href,n=e.children,r=(0,v.useContext)(nt.N).highlightColor;return(0,re.jsxs)(d.Link,{color:r,isExternal:!0,href:t,children:[n,(0,re.jsx)(V.ExternalLinkIcon,{mx:"1px",pb:"2px"})]})},gt=function(e){var t,n=e.href,r=e.children,o=e.nodeById,i=e.setSidebarHighlightedNode,l=e.setPreviewNode,s=e.onClickFunction,c=e.nodeByCite,a=e.openContextMenu,u=e.outline,h=e.noUnderline,g=e.linksByNodeId,f=e.isWiki,p=e.macros,x=e.attachDir,j=e.useInheritance,b=(0,v.useState)(null),m=b[0],y=b[1],C=(0,v.useState)(!1),w=C[0],k=C[1],O=n.replaceAll(/(.*?)\:.*/g,"$1"),S=u?ot:rt;if((0,v.useEffect)((function(){O.replaceAll(/(http)?.*/g,"$1")||m||w&&fetch("http://localhost:35901/node/".concat(L)).then((function(e){return e.text()})).then((function(e){"error"===e||y(e)})).catch((function(e){return console.log(e),"Could not fetch the text for some reason, sorry!\n\n This can happen because you have an id with forward slashes (/) in it."}))}),[w,m]),!O)return(0,re.jsx)(d.Text,{color:"gray.700",children:r});if(O.replaceAll(/(http)?.*/g,"$1"))return(0,re.jsx)(ht,{href:n,children:r});var I,N,P,B,D=n.replaceAll(/.*?\:(.*)/g,"$1"),L=function(e,t){if("id"===e)return t;if(e.includes("cite")){var n,r=null!==(n=c[t])&&void 0!==n&&n;return r?null!==r&&void 0!==r&&r.properties.FILELESS?"":null===r||void 0===r?void 0:r.id:""}return""}(O,D);encodeURIComponent(encodeURIComponent(null===(t=o[L])||void 0===t?void 0:t.file));return L?(0,re.jsx)(re.Fragment,{children:(0,re.jsxs)(et.J2,{gutter:12,trigger:"hover",placement:"top-start",children:[(0,re.jsx)(et.xo,{children:(0,re.jsx)(d.Box,{display:"inline",onMouseEnter:function(){return k(!0)},onMouseLeave:function(){return k(!1)},children:(0,re.jsx)(ut,{id:L,setSidebarHighlightedNode:i,setPreviewNode:l,onClickFunction:s,nodeById:o,href:n,children:r,nodeByCite:c,openContextMenu:a,noUnderline:h,isWiki:f},null!==(I=null===(N=o[L])||void 0===N?void 0:N.title)&&void 0!==I?I:L)})}),(0,re.jsx)(tt.h_,{children:(0,re.jsxs)(et.yk,{transform:"scale(1)",boxShadow:"xl",position:"relative",zIndex:"tooltip",onMouseEnter:function(){var e;i(null!==(e=o[L])&&void 0!==e?e:{})},onMouseLeave:function(){i({})},children:[(0,re.jsx)(et.QH,{}),(0,re.jsx)(et.b,{pb:5,fontSize:"xs",position:"relative",zIndex:"tooltip",transform:"scale(1)",width:"100%",children:(0,re.jsx)(lt.$B,{autoHeight:!0,autoHeightMax:300,autoHide:!0,renderThumbVertical:function(e){var t=e.style,n=(0,q.Z)(e,ct);return(0,re.jsx)(d.Box,dt({style:dt(dt({},t),{},{borderRadius:0})},n))},children:(0,re.jsx)(d.Box,{w:"100%",color:"black",px:3,sx:dt(dt({},it),S),children:(0,re.jsx)(kt,{previewText:m,nodeById:o,setSidebarHighlightedNode:i,setPreviewNode:l,onClickFunction:s,nodeByCite:c,openContextMenu:a,outline:u,linksByNodeId:g,macros:p,attachDir:x,useInheritance:j,previewNode:o[L],collapse:!1})})})})]},null!==(P=null===(B=o[L])||void 0===B?void 0:B.title)&&void 0!==P?P:L)})]})}):(0,re.jsx)(d.Text,{as:"span",display:"inline",className:n,color:"base.700",cursor:"not-allowed",children:r})},ft=n(25675),pt=n(62520),xt=n.n(pt),jt=function(e){var t=e.src,n=e.file;if(t.replaceAll(/(http)?.*/g,"$1"))return console.log(t.replaceAll(/(http)?.*/g,"$1")),(0,re.jsx)(ft.default,{layout:"responsive",loader:function(e){var t=e.src;return e.width,e.quality,"".concat(t)},src:t,alt:"",width:"auto",height:"auto"});var r=t.replaceAll(/file:/g,""),o=xt().dirname(n),i=xt().isAbsolute(r)||"~"===r.slice(0,1)?r:xt().join(o,r),l=encodeURIComponent(encodeURIComponent(i));return(0,re.jsx)(d.Container,{my:4,position:"relative",children:(0,re.jsx)("img",{alt:"Wow, an image.",src:"http://localhost:35901/img/".concat(l)})})},vt=n(14578),bt=(0,v.createContext)({outline:!1,collapse:!0}),mt=function(e){var t=e.children,n=e.className,r=(0,v.useState)(!0),o=r[0],i=r[1],l=(0,v.useContext)(bt).collapse;if((0,v.useEffect)((function(){i(!l)}),[l]),"h0Wrapper headingWrapper"===n)return(0,re.jsxs)(d.Box,{className:"preHeadingContent",children:[" ",t]});var s=t;return(0,re.jsxs)(d.Box,{className:"sec",children:[(0,re.jsx)(d.Box,{display:"block",children:(0,re.jsxs)(d.Flex,{className:"headingFlex",alignItems:"baseline",children:[o&&s.length>0?(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(h.IconButton,{className:"viewerHeadingButton",_focus:{},_active:{},"aria-label":"Expand heading",size:"xs",variant:"subtle",icon:(0,re.jsx)(V.ChevronUpIcon,{}),onClick:function(){return i(!o)},height:2,width:2}),(0,re.jsx)(h.IconButton,{className:"outlineHeadingButton",_focus:{},_active:{},"aria-label":"Expand heading",size:"xs",variant:"subtle",icon:(0,re.jsx)(vt.zOz,{}),onClick:function(){return i(!o)},height:2,width:2})]}):(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(h.IconButton,{className:"viewerHeadingButton",_active:{},_focus:{},"aria-label":"Collapse heading",height:2,width:2,size:"xs",variant:"subtle",icon:(0,re.jsx)(V.ChevronDownIcon,{}),onClick:function(){return i(!o)}}),(0,re.jsx)(h.IconButton,{className:"outlineHeadingButton",_active:{},_focus:{},"aria-label":"Collapse heading",height:2,width:2,size:"xs",variant:"subtle",icon:(0,re.jsx)(vt.O6Y,{}),onClick:function(){return i(!o)}})]}),s[0]]})}),o&&(0,re.jsx)(d.Box,{className:"sectionContent",children:s.slice(1)})]})};function yt(e){return["object"===typeof e.source?e.source.id:e.source,"object"===typeof e.target?e.target.id:e.target]}function Ct(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ct(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ct(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var kt=function(e){var t,n,r=e.nodeById,o=e.setSidebarHighlightedNode,l=e.setPreviewNode,s=e.onClickFunction,c=e.previewText,a=e.nodeByCite,u=e.previewNode,h=e.openContextMenu,f=e.outline,p=e.collapse,x=e.linksByNodeId,j=e.macros,b=e.attachDir,m=e.useInheritance,y=(0,v.useContext)(Ye).layout;if(!u||!x)return null;var C=we()().use(Oe()).use(De()).use(Fe(),{idDir:b||void 0,useInheritance:m}).use(Pe()).use(Ie(),{useSections:!0}),w=(null===(t=x[null===u||void 0===u?void 0:u.id])||void 0===t?void 0:t.reduce((function(e,t){var n=yt(t).filter((function(e){return e!==u.id})).join("");return wt(wt({},e),{},(0,i.Z)({},n,r[n]))}),{}))||{},k=Object.entries(w),O=we()().use(He()).use(qe(),["yaml"]).use(Qe()).use(Me.Z,{permaLinks:Object.keys(w),pageResolver:function(e){var t,n=k.find((function(t){var n;return(null===t||void 0===t||null===(n=t[1])||void 0===n?void 0:n.title)===e}));return[null!==(t=null===n||void 0===n?void 0:n[0])&&void 0!==t?t:""]},hrefTemplate:function(e){return"id:".concat(e)}}).use(Ke()).use(_e()).use(Ae()).use(Je()),S=".md"===(null===u||void 0===u||null===(n=u.file)||void 0===n?void 0:n.slice(-3)),I=S?O:C,N=(0,v.useMemo)((function(){return I.use(ze(),{trust:function(e){return["\\htmlId","\\href"].includes(e.command)},macros:wt({"\\eqref":"\\href{###1}{(\\text{#1})}","\\ref":"\\href{###1}{\\text{#1}}","\\label":"\\htmlId{#1}{}"},j)}).use(Re(),{createElement:v.createElement,components:{a:function(e){var t=e.children,n=e.href;return(0,re.jsx)(gt,{nodeByCite:a,setSidebarHighlightedNode:o,href:"".concat(n),nodeById:r,linksByNodeId:x,setPreviewNode:l,onClickFunction:s,openContextMenu:h,outline:f,isWiki:S,macros:j,attachDir:b,useInheritance:m,children:t})},img:function(e){var t=e.src;return(0,re.jsx)(jt,{src:t,file:null===u||void 0===u?void 0:u.file})},section:function(e){var t=e.children,n=e.className;return n&&n.slice(-1)==="".concat(u.level)?(0,re.jsx)(d.Box,{children:t.slice(1)}):(0,re.jsx)(mt,{outline:f,collapse:p,className:n,children:t})},blockquote:function(e){var t=e.children;return(0,re.jsx)(g.m$.blockquote,{color:"gray.800",bgColor:"gray.300",pt:4,pb:2,mb:4,mt:3,pl:4,borderLeftWidth:4,borderLeftColor:"gray.700",children:t})},p:function(e){var t=e.children;return(0,re.jsx)("p",{lang:"en",children:t})}}})}),[null===u||void 0===u?void 0:u.id,y]),P=(0,v.useMemo)((function(){return N.processSync(c).result}),[c,y]);return(0,re.jsx)(bt.Provider,{value:{collapse:p,outline:f},children:P})},Ot=function(e){var t=e.openContextMenu,n=e.setSidebarHighlightedNode,r=e.nodeById,o=e.nodeByCite,i=e.previewNode,l=e.setPreviewNode,s=e.onClickFunction,c=e.outline,a=e.collapse,d=e.linksByNodeId,u=e.macros,h=e.attachDir,g=e.useInheritance,f=(0,v.useState)(""),p=f[0],x=f[1],j=encodeURIComponent(encodeURIComponent(i.id));return(0,v.useEffect)((function(){fetch("http://localhost:35901/node/".concat(j)).then((function(e){return e.text()})).then((function(e){if(""===e)return"(empty node)";"error"!==e&&x(e)})).catch((function(e){return x("(could not find node)"),console.log(e),"Could not fetch the text for some reason, sorry!\n\n This can happen because you have an id with forward slashes (/) in it."}))}),[i.id]),(0,re.jsx)(re.Fragment,{children:p&&i&&(0,re.jsx)(kt,{nodeById:r,previewNode:i,setPreviewNode:l,onClickFunction:s,previewText:p,nodeByCite:o,setSidebarHighlightedNode:n,openContextMenu:t,outline:c,collapse:a,linksByNodeId:d,attachDir:h,useInheritance:g,macros:u||{}})})},St=function(e){var t,n=e.previewNode,r=e.setPreviewNode,o=e.onClickFunction,i=e.setSidebarHighlightedNode,s=e.nodeById,c=e.linksByNodeId,a=e.nodeByCite,u=e.openContextMenu,h=e.outline,g=e.macros,f=e.attachDir,p=e.useInheritance,x=(null!==(t=c[null===n||void 0===n?void 0:n.id])&&void 0!==t?t:[]).filter((function(e){var t=yt(e),r=(0,l.Z)(t,2),o=r[0];r[1];return o!==(null===n||void 0===n?void 0:n.id)})).map((function(e){return e.source}));return(0,re.jsxs)(d.Box,{className:"backlinks",borderRadius:"sm",mt:6,p:4,bg:"white",mb:10,children:[(0,re.jsx)("p",{style:{fontSize:16,fontWeight:600},children:"Linked references (".concat(x.length,")")}),(0,re.jsx)(d.VStack,{py:2,spacing:3,alignItems:"start",divider:(0,re.jsx)(d.StackDivider,{borderColor:"gray.500"}),align:"stretch",color:"gray.800",children:(null===n||void 0===n?void 0:n.id)&&x.map((function(e){var t,n,l;t=null===(n=s[e])||void 0===n?void 0:n.title;return(0,re.jsx)(d.Box,{overflow:"hidden",py:1,borderRadius:"sm",width:"100%",children:(0,re.jsx)(gt,{linksByNodeId:c,nodeByCite:a,setSidebarHighlightedNode:i,href:"id:".concat(e),nodeById:s,setPreviewNode:r,onClickFunction:o,openContextMenu:u,outline:h,noUnderline:!0,attachDir:f,useInheritance:p,macros:g,children:null===(l=s[e])||void 0===l?void 0:l.title})},e)}))})]})};function It(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Nt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?It(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):It(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Pt=function(e){var t=e.setPreviewNode,n=e.onClickFunction,r=e.justificationList,o=e.justification,i=e.previewNode,l=e.nodeById,s=e.nodeByCite,c=e.setSidebarHighlightedNode,a=e.linksByNodeId,u=e.openContextMenu,h=e.outline,g=e.collapse,f=e.macros,p=e.attachDir,x=e.useInheritance,j=((0,v.useContext)(Ye).layout,h?ot:rt);return(0,re.jsx)(d.Box,{pr:8,pt:2,height:"100%",className:"org",sx:Nt(Nt(Nt({},it),j),{},{textAlign:r[o]}),children:(null===i||void 0===i?void 0:i.id)&&(0,re.jsxs)(d.Flex,{className:"wrapClass",height:"100%",flexDirection:"column",justifyContent:"space-between",children:[(0,re.jsx)(Ot,{setPreviewNode:t,onClickFunction:n,previewNode:i,nodeByCite:s,setSidebarHighlightedNode:c,openContextMenu:u,outline:h,collapse:g,nodeById:l,linksByNodeId:a,macros:f,attachDir:p,useInheritance:x}),(0,re.jsx)(St,{setPreviewNode:t,onClickFunction:n,previewNode:i,nodeById:l,linksByNodeId:a,nodeByCite:s,setSidebarHighlightedNode:c,openContextMenu:u,outline:h,attachDir:p,useInheritance:x,macros:f||{}})]})})},Bt=function(e){var t=e.previewNode;return(0,re.jsx)(d.Flex,{maxW:"90%",children:(0,re.jsx)(d.Heading,{lineHeight:1.2,size:"md",fontWeight:600,children:null===t||void 0===t?void 0:t.title})})},Dt=n(29119);function Lt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ft(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lt(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Tt(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=zt(e,null!==(n=r.storage)&&void 0!==n?n:localStorage),i=o.get(),l=void 0!==i?i:t,s=null!=i&&"object"===typeof i&&!1===Array.isArray(i)?Ft(Ft({},t),i):l;s!==i&&o.update(s);var c=(0,v.useState)(s),a=c[0],d=c[1];(0,v.useEffect)((function(){a!==s&&d(s)}),[e]);var u=function(e){e instanceof Function?d((function(t){var n=e(t);return o.update(n),n})):(d(e),o.update(e))};return[a,u]}function zt(e,t){return{get:function(){var n=t.getItem(e);if(n&&"undefined"!==n)return JSON.parse(n)},update:function(n){t.setItem(e,JSON.stringify(n))},remove:function(){t.removeItem(e)}}}var Et=["style"];function Rt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rt(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ht=function(e){var t=e.isOpenSidebar,n=e.onOpenSidebar,r=e.onCloseSidebar,o=e.previewNode,i=e.setPreviewNode,s=e.nodeById,c=e.linksByNodeId,a=e.nodeByCite,u=e.setSidebarHighlightedNode,g=e.canUndo,f=e.canRedo,p=e.resetPreviewNode,x=e.previousPreviewNode,j=e.nextPreviewNode,b=e.openContextMenu,m=(e.scope,e.setScope,e.windowWidth),C=e.filter,w=e.setFilter,k=e.tagColors,O=e.setTagColors,S=e.macros,I=e.attachDir,N=e.useInheritance,P=((0,v.useContext)(nt.N).highlightColor,(0,v.useState)()),B=P[0],D=P[1],L=Tt("sidebarWidth",400),F=(0,l.Z)(L,2),T=F[0],z=F[1];(0,v.useEffect)((function(){null!==o&&void 0!==o&&o.id?(n(),D(o)):r()}),[null===o||void 0===o?void 0:o.id]);var E=Tt("justification",1),R=(0,l.Z)(E,2),Z=R[0],H=R[1],W=Tt("outline",!1),A=(0,l.Z)(W,2),M=A[0],V=A[1],_=(0,v.useState)("sans serif"),U=(_[0],_[1]),X=(0,v.useState)(0),Q=(X[0],X[1]),G=(0,v.useState)(!1),K=G[0],$=G[1];return(0,re.jsx)(de,{animateOpacity:!1,dimension:"width",in:t,unmountOnExit:!0,startingSize:0,style:{height:"100vh"},children:(0,re.jsx)(Dt.e,{size:{height:"100vh",width:T},onResizeStop:function(e,t,n,r){z((function(e){return e+r.width}))},enable:{top:!1,right:!1,bottom:!1,left:!0,topRight:!1,bottomRight:!1,bottomLeft:!1,topLeft:!1},minWidth:"220px",maxWidth:m-200,children:(0,re.jsxs)(d.Flex,{flexDir:"column",h:"100vh",pl:2,color:"black",bg:"alt.100",width:"100%",children:[(0,re.jsxs)(d.Flex,{pl:2,alignItems:"center",color:"black",width:"100%",children:[(0,re.jsx)(d.Flex,{pt:1,flexShrink:0,children:(0,re.jsx)(je,{setJustification:H,setIndent:Q,setFont:U,justification:Z,setPreviewNode:i,canUndo:g,canRedo:f,resetPreviewNode:p,previousPreviewNode:x,nextPreviewNode:j,outline:M,setOutline:V,collapse:K,setCollapse:$})}),(0,re.jsx)(d.Flex,{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",onContextMenu:function(e){e.preventDefault(),b(o,e)}}),(0,re.jsx)(d.Flex,{flexDir:"row",ml:"auto",children:(0,re.jsx)(h.IconButton,{m:1,icon:(0,re.jsx)(y.T41,{}),"aria-label":"Options",variant:"subtle",onClick:function(e){b(o,e,{left:void 0,top:12,right:20-m,bottom:void 0})}})})]}),(0,re.jsx)(lt.$B,{autoHide:!0,renderThumbVertical:function(e){var t=e.style,n=(0,q.Z)(e,Et);return(0,re.jsx)(d.Box,Zt({style:Zt(Zt({},t),{},{borderRadius:0})},n))},children:B&&(0,re.jsxs)(d.VStack,{flexGrow:1,alignItems:"left",bg:"alt.100",paddingLeft:4,children:[(0,re.jsx)(Bt,{previewNode:B}),(0,re.jsx)(ye,{filter:C,setFilter:w,tagColors:k,setTagColors:O,openContextMenu:b,previewNode:o}),(0,re.jsx)(Pt,{setPreviewNode:i,previewNode:o,nodeById:s,nodeByCite:a,setSidebarHighlightedNode:u,justification:Z,justificationList:["justify","start","end","center"],linksByNodeId:c,openContextMenu:b,outline:M,setOutline:V,collapse:K,macros:S,attachDir:I,useInheritance:N,onClickFunction:function(e){return i(s[e])}})]})})]})})})},Wt=n(94090),At=n(69968),Mt=n.n(At);n(18025),n(83456);function Vt(e){var t=e.previewNodeId,n=e.setPreviewNode,r=e.onClickFunction,o=e.nodeById,i=e.nodeByCite,l=e.linksByNodeId,s=e.setSidebarHighlightedNode,c=e.onCloseDeskCard,a=e.macros,u=e.attachDir,g=e.useInheritance,f=e.webSocket,p=((0,v.useContext)(Ye).layout,o[t]);return(0,re.jsxs)(lt.$B,{children:[(0,re.jsxs)(d.Flex,{mr:3,children:[(0,re.jsx)(Bt,{previewNode:p}),(0,re.jsx)(d.Spacer,{}),(0,re.jsx)(h.IconButton,{className:"nodrag",variant:"subtle","aria-label":"Edit",size:"xs",icon:(0,re.jsx)(V.EditIcon,{}),onClick:function(){return U(p,f)}}),(0,re.jsx)(h.IconButton,{className:"nodrag",variant:"subtle","aria-label":"Close",size:"xs",icon:(0,re.jsx)(V.CloseIcon,{}),onClick:function(){return c(t)}})]}),(0,re.jsx)(Pt,{previewNode:p,setPreviewNode:n,onClickFunction:r,justificationList:["start"],justification:0,nodeById:o,nodeByCite:i,setSidebarHighlightedNode:s,linksByNodeId:l,openContextMenu:null,outline:!1,collapse:!1,macros:a,attachDir:u,useInheritance:g})]})}function _t(e){var t=e.onLayoutChange,n=e.onCloseDeskCard,r=e.onClickFunction,o=e.setPreviewNode,i=e.nodeById,l=e.nodeByCite,s=e.setSidebarHighlightedNode,c=e.linksByNodeId,a=e.macros,u=e.attachDir,h=e.useInheritance,g=e.windowWidth,f=e.webSocket,p=(0,v.useContext)(Ye).layout;return(0,re.jsx)(Mt(),{layout:p,cols:48,rowHeight:100,width:g-50,containerPadding:[20,20],isDroppable:!0,onLayoutChange:t,resizeHandles:["s","n","e","w","sw","nw","se","ne"],draggableCancel:".nodrag",allowOverlap:!0,children:p.map((function(e){return t=e.i,(0,re.jsx)(d.Box,{className:"card",p:2,pr:0,bg:"white",borderWidth:"1px",boxShadow:"lg",children:(0,re.jsx)(Vt,{previewNodeId:t,onClickFunction:r,setPreviewNode:o,nodeById:i,nodeByCite:l,linksByNodeId:c,setSidebarHighlightedNode:s,onCloseDeskCard:n,macros:a,attachDir:u,useInheritance:h,webSocket:f})},t);var t}))})}var Ut=n(47647),qt=function(e){var t=e.nodeById,n=void 0===t?{}:t,r=e.selectedItems,o=e.onSelectedItemsChange,i=(0,v.useContext)(nt.N).highlightColor,l=Object.values(n),s=(null===l||void 0===l?void 0:l.map((function(e){return{value:null===e||void 0===e?void 0:e.id,label:null===e||void 0===e?void 0:e.title}})))||[];return(0,re.jsx)(Ut.CUIAutoComplete,{labelStyleProps:{fontWeight:300,fontSize:14},items:s,label:"",placeholder:"Choose nodes... ",selectedItems:r,onSelectedItemsChange:function(e){return o(e,r)},listItemStyleProps:{overflow:"hidden",fontSize:12,height:6},highlightItemBg:"gray.400",toggleButtonStyleProps:{variant:"outline"},inputStyleProps:{mt:1,height:6,focusBorderColor:i,color:"gray.800",borderColor:"gray.500",fontSize:12},tagStyleProps:{justifyContent:"flex-start",fontSize:12,borderColor:i,borderWidth:1,borderRadius:"md",color:i,bg:"",height:4,mb:1},hideToggleButton:!0,itemRenderer:function(e){return e.label},disableCreateItem:!0})};function Xt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xt(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Gt(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Kt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Kt(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){s=!0,i=e},f:function(){try{l||null==n.return||n.return()}finally{if(s)throw i}}}}function Kt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var $t=function(e){var t=e.nodeById,n=(e.nodeByCite,e.linksByNodeId,e.isOpenDesk),r=(e.onOpenDesk,e.onCloseDesk),o=e.selectedItems,i=e.setSelectedItems,l=(e.setPreviewNode,e.setSidebarHighlightedNode,e.macros,e.attachDir,e.useInheritance,e.windowWidth,e.webSocket,(0,v.useContext)(Ye)),s=l.layout,c=l.setLayout;function a(e,t){return void 0===t.find((function(t){return t.i==e}))&&(c(t.concat({i:e,x:0,y:1/0,w:12,h:4})),!0)}var u=function(e){c(s.filter((function(t){return t.i!==e}))),i(o.filter((function(t){return t.value!==e})))};return(0,re.jsxs)(M.u_,{isOpen:n,onClose:r,size:"full",children:[(0,re.jsx)(M.ZA,{}),(0,re.jsxs)(M.hz,{height:"70%",children:[(0,re.jsx)(Wt.UQ,{allowToggle:!0,defaultIndex:[0],ml:2,w:"95%",borderWidth:1,children:(0,re.jsxs)(Wt.Qd,{mt:0,children:[(0,re.jsxs)(Wt.KF,{_expanded:{bg:"gray.100"},children:[(0,re.jsx)(d.Box,{as:"span",flex:"1",textAlign:"left",children:"\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435"}),(0,re.jsx)(Wt.XE,{})]}),(0,re.jsxs)(Wt.Hk,{children:[(0,re.jsx)(h.Button,{onClick:function(){i([]),c([])},size:"xs",variant:"outline",children:"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c"}),(0,re.jsx)(qt,{nodeById:t,selectedItems:o,onSelectedItemsChange:function(e,t){var n=function(){var n,r=Gt(t);try{for(r.s();!(n=r.n()).done;){var o=n.value;e.selectedItems.includes(o)||u(o.value)}}catch(i){r.e(i)}finally{r.f()}},r=function(){var n,r=Gt(e.selectedItems);try{for(r.s();!(n=r.n()).done;){var o=n.value;t.includes(o)||a(o.value,s)}}catch(i){r.e(i)}finally{r.f()}};switch(e.type){case 9:case"__function_remove_selected_item__":n();break;case 8:case"__function_add_selected_item__":r();break;default:console.log("Unknown action on Selected node")}e.selectedItems&&i(e.selectedItems)}})]})]})}),(0,re.jsx)(M.ol,{}),(0,re.jsx)(lt.$B,{children:(0,re.jsx)(M.fe,{children:(0,re.jsx)(_t,Qt(Qt({},e),{},{onClickFunction:function(e){return a(e,s)},onLayoutChange:function(e){c(e)},onCloseDeskCard:u}))})})]})]})},Jt=n(88696);function Yt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function en(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yt(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var tn=function(e){var t,n=e.filter,r=e.listName,o=e.labelFilter,l=e.displayName,s=e.setFilter,c=e.options,a=void 0===c?[]:c,d=(0,v.useContext)(nt.N).highlightColor,u=(null===a||void 0===a?void 0:a.map((function(e){return{value:e,label:o?e.replace(o,""):e}})))||[],h=(0,v.useState)((null===(t=n[r])||void 0===t?void 0:t.map((function(e){return{value:e,label:o?null===e||void 0===e?void 0:e.replace(o,""):e}})))||[]),g=h[0],f=h[1];return(0,re.jsx)(Ut.CUIAutoComplete,{labelStyleProps:{fontWeight:300,fontSize:14},items:u,label:"Add tag to ".concat(l),placeholder:" ",onCreateItem:function(e){return null},disableCreateItem:!0,selectedItems:g,onSelectedItemsChange:function(e){e.selectedItems&&(f(e.selectedItems),s(en(en({},n),{},(0,i.Z)({},r,e.selectedItems.map((function(e){return e.value}))))))},listItemStyleProps:{overflow:"hidden"},highlightItemBg:"gray.400",toggleButtonStyleProps:{variant:"outline"},inputStyleProps:{mt:2,height:8,focusBorderColor:d,color:"gray.800",borderColor:"gray.500"},tagStyleProps:{justifyContent:"flex-start",fontSize:10,borderColor:d,borderWidth:1,borderRadius:"md",color:d,bg:"",height:4,mb:2},hideToggleButton:!0,itemRenderer:function(e){return e.label}})};function nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nn(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var on=function(e){var t=e.colorList,n=e.tagColors,r=e.setTagColors,o=e.highlightColor,l=e.tags.map((function(e){return{value:e,label:e}})),s=(0,v.useState)(Object.keys(n).map((function(e){return{value:e,label:e}}))),c=s[0],a=s[1];return(0,re.jsxs)(d.Box,{children:[(0,re.jsx)(Ut.CUIAutoComplete,{items:l,labelStyleProps:{fontWeight:300,fontSize:14},label:"Add tag to color",placeholder:" ",disableCreateItem:!0,selectedItems:c,onSelectedItemsChange:function(e){e.selectedItems&&(a(Array.from(new Set(e.selectedItems))),r(Object.fromEntries(Array.from(new Set(e.selectedItems)).map((function(e){var t;return[e.label,null!==(t=n[e.label])&&void 0!==t?t:"gray.600"]})))))},listItemStyleProps:{overflow:"hidden"},highlightItemBg:"gray.400",toggleButtonStyleProps:{variant:"outline"},inputStyleProps:{height:8,focusBorderColor:o,color:"gray.800",borderColor:"gray.500"},tagStyleProps:{display:"none",rounded:"full",bg:o,height:8,paddingLeft:4,fontWeight:"bold"},hideToggleButton:!0,itemRenderer:function(e){return e.label}}),(0,re.jsx)(d.VStack,{spacing:2,justifyContent:"flex-start",divider:(0,re.jsx)(d.StackDivider,{borderColor:"gray.500"}),align:"stretch",color:"gray.800",children:Object.keys(n).map((function(e){return(0,re.jsxs)(d.Flex,{alignItems:"center",justifyContent:"space-between",width:"100%",pl:2,children:[(0,re.jsx)(d.Box,{width:"100%",children:(0,re.jsx)(d.Text,{children:e})}),(0,re.jsxs)(A.v2,{isLazy:!0,placement:"right",children:[(0,re.jsx)(A.j2,{as:h.Button,colorScheme:"",color:"black",children:(0,re.jsx)(d.Box,{bgColor:n[e],borderRadius:"sm",height:6,width:6})}),(0,re.jsx)(tt.h_,{children:(0,re.jsx)(A.qy,{minW:10,zIndex:"popover",bgColor:"gray.200",children:t.map((function(t){return(0,re.jsx)(A.sN,{onClick:function(){return r(rn(rn({},n),{},(0,i.Z)({},e,t)))},justifyContent:"space-between",alignItems:"center",display:"flex",children:(0,re.jsx)(d.Box,{bgColor:t,borderRadius:"sm",height:6,width:6})},t)}))})})]}),(0,re.jsx)(h.IconButton,{"aria-label":"Delete tag color",variant:"ghost",icon:(0,re.jsx)(V.DeleteIcon,{}),onClick:function(){r(Object.fromEntries(Array.from(new Set(c)).map((function(e){var t;return[e.label,null!==(t=n[e.label])&&void 0!==t?t:"gray.600"]})))),a(c.filter((function(t){return t.value!==e})))}})]},e)}))})]})};function ln(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function sn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ln(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ln(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var cn=function(e){var t=e.colorList,n=e.linktagColors,r=e.setLinkTagColors,o=e.highlightColor,l=e.tags.map((function(e){return{value:e,label:e}})),s=(0,v.useState)(Object.keys(n).map((function(e){return{value:e,label:e}}))),c=s[0],a=s[1];return(0,re.jsxs)(d.Box,{children:[(0,re.jsx)(Ut.CUIAutoComplete,{items:l,labelStyleProps:{fontWeight:300,fontSize:14},label:"Add link tag to color",placeholder:" ",disableCreateItem:!0,selectedItems:c,onSelectedItemsChange:function(e){e.selectedItems&&(a(Array.from(new Set(e.selectedItems))),r(Object.fromEntries(Array.from(new Set(e.selectedItems)).map((function(e){var t;return[e.label,null!==(t=n[e.label])&&void 0!==t?t:"gray.600"]})))))},listItemStyleProps:{overflow:"hidden"},highlightItemBg:"gray.400",toggleButtonStyleProps:{variant:"outline"},inputStyleProps:{height:8,focusBorderColor:o,color:"gray.800",borderColor:"gray.500"},tagStyleProps:{display:"none",rounded:"full",bg:o,height:8,paddingLeft:4,fontWeight:"bold"},hideToggleButton:!0,itemRenderer:function(e){return e.label}}),(0,re.jsx)(d.VStack,{spacing:2,justifyContent:"flex-start",divider:(0,re.jsx)(d.StackDivider,{borderColor:"gray.500"}),align:"stretch",color:"gray.800",children:Object.keys(n).map((function(e){return(0,re.jsxs)(d.Flex,{alignItems:"center",justifyContent:"space-between",width:"100%",pl:2,children:[(0,re.jsx)(d.Box,{width:"100%",children:(0,re.jsx)(d.Text,{children:e})}),(0,re.jsxs)(A.v2,{isLazy:!0,placement:"right",children:[(0,re.jsx)(A.j2,{as:h.Button,colorScheme:"",color:"black",children:(0,re.jsx)(d.Box,{bgColor:n[e],borderRadius:"sm",height:6,width:6})}),(0,re.jsx)(tt.h_,{children:(0,re.jsx)(A.qy,{minW:10,zIndex:"popover",bgColor:"gray.200",children:t.map((function(t){return(0,re.jsx)(A.sN,{onClick:function(){return r(sn(sn({},n),{},(0,i.Z)({},e,t)))},justifyContent:"space-between",alignItems:"center",display:"flex",children:(0,re.jsx)(d.Box,{bgColor:t,borderRadius:"sm",height:6,width:6})},t)}))})})]}),(0,re.jsx)(h.IconButton,{"aria-label":"Delete tag color",variant:"ghost",icon:(0,re.jsx)(V.DeleteIcon,{}),onClick:function(){r(Object.fromEntries(Array.from(new Set(c)).map((function(e){var t;return[e.label,null!==(t=n[e.label])&&void 0!==t?t:"gray.600"]})))),a(c.filter((function(t){return t.value!==e})))}})]},e)}))})]})},an=n(80918),dn=function(e){var t=e.infoText;return(0,re.jsx)(d.Box,{paddingLeft:"1",children:(0,re.jsx)(u.u,{label:t,placement:"top",color:"gray.100",bg:"gray.800",hasArrow:!0,children:(0,re.jsx)(V.InfoOutlineIcon,{})})})},un=["min","max","step","value"],hn=function(e){var t=e.min,n=void 0===t?0:t,r=e.max,o=void 0===r?10:r,i=e.step,l=void 0===i?.1:i,s=e.value,c=void 0===s?1:s,a=(0,q.Z)(e,un),h=a.onChange,g=a.label,f=a.infoText,p=(0,v.useContext)(nt.N).highlightColor;return(0,re.jsxs)(d.Box,{pt:1,pb:2,children:[(0,re.jsxs)(d.Box,{display:"flex",alignItems:"flex-end",mb:2,children:[(0,re.jsx)(d.Text,{children:g}),f&&(0,re.jsx)(dn,{infoText:f})]}),(0,re.jsxs)(an.iR,{value:c,onChange:h,min:n,max:o,step:l,children:[(0,re.jsx)(an.Uj,{children:(0,re.jsx)(an.Ms,{})}),(0,re.jsx)(u.u,{bg:p,label:c.toFixed(1),children:(0,re.jsx)(an.gs,{bg:"white"})})]})]},g)},gn=(0,v.createContext)({subDirs:["dailies",".attach"],attachDir:".attach",useInheritance:!1,roamDir:"~/org",dailyDir:"dailies"});function fn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fn(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var xn=function(e){var t=e.filter,n=e.setFilter,r=e.local,o=e.setLocal,i=e.tagColors,l=e.setTagColors,s=e.linktagColors,c=e.setLinkTagColors,a=e.highlightColor,u=e.colorList,g=e.tags,f=e.linktags,p=(0,v.useContext)(gn),x=p.roamDir,j=p.subDirs;return(0,re.jsxs)(d.Box,{children:[(0,re.jsxs)(d.VStack,{spacing:2,justifyContent:"flex-start",divider:(0,re.jsx)(d.StackDivider,{borderColor:"gray.500"}),align:"stretch",paddingLeft:7,color:"gray.800",children:[(0,re.jsxs)(d.Flex,{alignItems:"center",justifyContent:"space-between",children:[(0,re.jsx)(d.Text,{children:"Link children to"}),(0,re.jsxs)(A.v2,{isLazy:!0,placement:"right",children:[(0,re.jsx)(A.j2,{as:h.Button,rightIcon:(0,re.jsx)(V.ChevronDownIcon,{}),colorScheme:"",color:"black",size:"sm",children:function(){switch(t.parent){case"parent":return(0,re.jsx)(d.Text,{children:"File"});case"heading":return(0,re.jsx)(d.Text,{children:"Heading"});default:return(0,re.jsx)(d.Text,{children:"Nothing"})}}()}),(0,re.jsx)(tt.h_,{children:(0,re.jsxs)(A.qy,{bgColor:"gray.200",zIndex:"popover",children:[(0,re.jsx)(A.sN,{onClick:function(){return n((function(e){return pn(pn({},e),{},{parent:""})}))},children:"Nothing"}),(0,re.jsx)(A.sN,{onClick:function(){return n((function(e){return pn(pn({},e),{},{parent:"parent"})}))},children:"Parent file node"}),(0,re.jsx)(A.sN,{onClick:function(){return n((function(e){return pn(pn({},e),{},{parent:"heading"})}))},children:"Next highest heading node"})]})})]})]}),(0,re.jsxs)(d.Flex,{justifyContent:"space-between",children:[(0,re.jsx)(d.Text,{children:"Orphans"}),(0,re.jsx)(Jt.r,{onChange:function(){n((function(e){return pn(pn({},e),{},{orphans:!e.orphans})}))},isChecked:t.orphans})]}),(0,re.jsxs)(d.Flex,{justifyContent:"space-between",children:[(0,re.jsx)(d.Text,{children:"Dailies"}),(0,re.jsx)(Jt.r,{onChange:function(){n((function(e){return pn(pn({},e),{},{dailies:!e.dailies})}))},isChecked:t.dailies})]}),(0,re.jsxs)(d.Flex,{justifyContent:"space-between",children:[(0,re.jsx)(d.Text,{children:"Org-noter pages"}),(0,re.jsx)(Jt.r,{onChange:function(){n((function(e){return pn(pn({},e),{},{noter:!e.noter})}))},isChecked:t.noter})]}),(0,re.jsxs)(d.Flex,{justifyContent:"space-between",children:[(0,re.jsx)(d.Text,{children:"Citations without note files"}),(0,re.jsx)(Jt.r,{onChange:function(){n(pn(pn({},t),{},{filelessCites:!t.filelessCites}))},isChecked:t.filelessCites})]}),(0,re.jsxs)(d.Flex,{justifyContent:"space-between",children:[(0,re.jsx)(d.Text,{children:"Non-existent nodes"}),(0,re.jsx)(Jt.r,{onChange:function(){l(pn(pn({},i),{},{bad:"white"})),n(pn(pn({},t),{},{bad:!t.bad}))},isChecked:t.bad})]}),(0,re.jsx)(hn,{label:"Number of neighbors in local graph",value:r.neighbors,onChange:function(e){return o(pn(pn({},r),{},{neighbors:e}))},min:1,max:5,step:1})]}),(0,re.jsxs)(Wt.UQ,{padding:0,allowToggle:!0,allowMultiple:!0,paddingLeft:3,children:[(0,re.jsxs)(Wt.Qd,{children:[(0,re.jsxs)(Wt.KF,{children:["Directory filters",(0,re.jsx)(Wt.XE,{})]}),(0,re.jsxs)(Wt.Hk,{pr:0,mr:0,children:[(0,re.jsx)(tn,{filter:t,setFilter:n,options:j,displayName:"directory blocklist",listName:"dirsBlocklist",labelFilter:x}),(0,re.jsx)(tn,{filter:t,setFilter:n,options:j,displayName:"directory allowlist",listName:"dirsAllowlist",labelFilter:x})]})]}),(0,re.jsxs)(Wt.Qd,{children:[(0,re.jsxs)(Wt.KF,{children:["Tag filters",(0,re.jsx)(Wt.XE,{})]}),(0,re.jsxs)(Wt.Hk,{pr:0,mr:0,children:[(0,re.jsx)(tn,{filter:t,setFilter:n,options:g,displayName:"tag blocklist",listName:"tagsBlacklist"}),(0,re.jsx)(tn,{filter:t,setFilter:n,options:g,displayName:"tag allowlist",listName:"tagsWhitelist"})]})]}),(0,re.jsxs)(Wt.Qd,{children:[(0,re.jsxs)(Wt.KF,{children:["Tag colors",(0,re.jsx)(Wt.XE,{})]}),(0,re.jsx)(Wt.Hk,{pr:0,mr:0,children:(0,re.jsx)(on,{tags:g,colorList:u,tagColors:i,setTagColors:l,highlightColor:a})})]}),(0,re.jsxs)(Wt.Qd,{children:[(0,re.jsxs)(Wt.KF,{children:["Link Tag filters",(0,re.jsx)(Wt.XE,{})]}),(0,re.jsxs)(Wt.Hk,{pr:0,mr:0,children:[(0,re.jsx)(tn,{filter:t,setFilter:n,options:f,displayName:"linktag blocklist",listName:"linktagsBlacklist"}),(0,re.jsx)(tn,{filter:t,setFilter:n,options:f,displayName:"linktag allowlist",listName:"linktagsWhitelist"})]})]}),(0,re.jsxs)(Wt.Qd,{children:[(0,re.jsxs)(Wt.KF,{children:["Link Tag colors",(0,re.jsx)(Wt.XE,{})]}),(0,re.jsx)(Wt.Hk,{pr:0,mr:0,children:(0,re.jsx)(cn,{tags:f,colorList:u,linktagColors:s,setLinkTagColors:c,highlightColor:a})})]})]})]})},jn=n(37496),vn=function(e){var t=e.value,n=e.onChange,r=e.label,o=e.infoText,i=e.children;return(0,re.jsxs)(d.Box,{paddingTop:2,children:[(0,re.jsxs)(d.Box,{display:"flex",justifyContent:"space-between",paddingBottom:2,children:[(0,re.jsxs)(d.Box,{display:"flex",alignItems:"center",children:[(0,re.jsx)(d.Text,{children:r}),o&&(0,re.jsx)(dn,{infoText:o})]}),(0,re.jsx)(Jt.r,{isChecked:!!t,onChange:n})]}),(0,re.jsx)(jn.UO,{in:!!t,animateOpacity:!0,children:(0,re.jsx)(d.Box,{paddingLeft:4,paddingTop:2,paddingBottom:2,children:i})})]},r)};function bn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bn(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var yn=function(e){var t=e.physics,n=e.setPhysics,r=(0,v.useCallback)((function(e,t,r){n((function(n){return mn(mn({},n),{},(0,i.Z)({},t,e/r))}))}),[]);return(0,re.jsxs)(d.Box,{children:[(0,re.jsxs)(d.VStack,{spacing:2,justifyContent:"flex-start",divider:(0,re.jsx)(d.StackDivider,{borderColor:"gray.500"}),align:"stretch",paddingLeft:7,color:"gray.800",children:[(0,re.jsxs)(vn,{label:"Gravity",value:t.gravityOn,onChange:function(){return n(mn(mn({},t),{},{gravityOn:!t.gravityOn}))},children:[(0,re.jsxs)(d.Flex,{justifyContent:"space-between",children:[(0,re.jsx)(d.Text,{children:"Also in local"}),(0,re.jsx)(Jt.r,{onChange:function(){n((function(e){return mn(mn({},e),{},{gravityLocal:!e.gravityLocal})}))},isChecked:t.gravityLocal})]}),(0,re.jsx)(hn,{label:"Strength",value:10*t.gravity,onChange:function(e){return r(e,"gravity",10)}})]}),(0,re.jsx)(hn,{value:-t.charge/100,onChange:function(e){return r(e,"charge",-.01)},label:"Repulsive Force"}),(0,re.jsx)(hn,{value:5*t.linkStrength,onChange:function(e){return r(e,"linkStrength",5)},label:"Link Force"}),(0,re.jsx)(hn,{label:"Stabilization rate",value:50*t.alphaDecay,onChange:function(e){return r(e,"alphaDecay",50)}})]}),(0,re.jsx)(d.Box,{children:(0,re.jsx)(Wt.UQ,{paddingLeft:3,allowToggle:!0,children:(0,re.jsxs)(Wt.Qd,{children:[(0,re.jsxs)(Wt.KF,{children:[(0,re.jsx)(d.Text,{children:"Advanced"}),(0,re.jsx)(Wt.XE,{marginRight:2})]}),(0,re.jsx)(Wt.Hk,{children:(0,re.jsxs)(d.VStack,{spacing:2,justifyContent:"flex-start",divider:(0,re.jsx)(d.StackDivider,{borderColor:"gray.500"}),align:"stretch",paddingLeft:3,color:"gray.800",children:[(0,re.jsx)(vn,{label:"Collision",infoText:"Perfomance sap, disable if slow",value:t.collision,onChange:function(){return n(mn(mn({},t),{},{collision:!t.collision}))},children:(0,re.jsx)(hn,{value:t.collisionStrength/5,onChange:function(e){return r(e,"collisionStrength",.2)},label:"Collision Radius",infoText:"Easy with this one, high values can lead to a real jiggly mess"})}),(0,re.jsx)(hn,{label:"Link iterations",value:t.linkIts,onChange:function(e){return r(e,"linkIts",1)},min:0,max:6,step:1,infoText:"How many links down the line the physics of a single node affects (Slow)"}),(0,re.jsx)(hn,{label:"Viscosity",value:10*t.velocityDecay,onChange:function(e){return r(e,"velocityDecay",10)}}),(0,re.jsx)(vn,{label:"Center nodes",value:t.centering,onChange:function(){return n(mn(mn({},t),{},{centering:!t.centering}))},infoText:"Keeps the nodes in the center of the viewport. If disabled you can drag the nodes anywhere you want.",children:(0,re.jsx)(hn,{label:"Centering Strength",value:t.centeringStrength,max:2,step:.01,onChange:function(e){return r(e,"centeringStrength",1)}})})]})})]})})})]})};function Cn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cn(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var kn=function(e){var t=e.behavior,n=e.setBehavior,r=e.mouse,o=e.setMouse;return(0,re.jsxs)(d.VStack,{spacing:2,justifyContent:"flex-start",divider:(0,re.jsx)(d.StackDivider,{borderColor:"gray.500"}),align:"stretch",paddingLeft:7,color:"gray.800",children:[(0,re.jsxs)(d.Flex,{alignItems:"center",justifyContent:"space-between",children:[(0,re.jsx)(d.Text,{children:"Preview node"}),(0,re.jsxs)(A.v2,{isLazy:!0,placement:"right",children:[(0,re.jsx)(A.j2,{as:h.Button,rightIcon:(0,re.jsx)(V.ChevronDownIcon,{}),colorScheme:"",color:"black",children:(0,re.jsx)(d.Text,{children:r.preview?r.preview[0].toUpperCase()+r.preview.slice(1):"Never"})}),(0,re.jsxs)(tt.h_,{children:[" ",(0,re.jsxs)(A.qy,{bgColor:"gray.200",zIndex:"popover",children:[(0,re.jsx)(A.sN,{onClick:function(){return o(wn(wn({},r),{},{preview:""}))},children:"Never"}),(0,re.jsx)(A.sN,{onClick:function(){return o(wn(wn({},r),{},{preview:"click"}))},children:"Click"}),(0,re.jsx)(A.sN,{onClick:function(){return o(wn(wn({},r),{},{preview:"double"}))},children:"Double Click"})]})]})]})]}),(0,re.jsxs)(d.Flex,{alignItems:"center",justifyContent:"space-between",children:[(0,re.jsxs)(d.Flex,{children:[(0,re.jsx)(d.Text,{children:"Expand Node"}),(0,re.jsx)(dn,{infoText:"View only the node and its direct neighbors"})]}),(0,re.jsxs)(A.v2,{isLazy:!0,placement:"right",children:[(0,re.jsx)(A.j2,{as:h.Button,rightIcon:(0,re.jsx)(V.ChevronDownIcon,{}),colorScheme:"",color:"black",children:(0,re.jsx)(d.Text,{children:r.local?r.local[0].toUpperCase()+r.local.slice(1):"Never"})}),(0,re.jsxs)(tt.h_,{children:[" ",(0,re.jsxs)(A.qy,{zIndex:"popover",bgColor:"gray.200",children:[(0,re.jsx)(A.sN,{onClick:function(){return o(wn(wn({},r),{},{local:""}))},children:"Never"}),(0,re.jsx)(A.sN,{onClick:function(){return o(wn(wn({},r),{},{local:"click"}))},children:"Click"}),(0,re.jsx)(A.sN,{onClick:function(){return o(wn(wn({},r),{},{local:"double"}))},children:"Double Click"}),(0,re.jsx)(A.sN,{onClick:function(){return o(wn(wn({},r),{},{local:"right"}))},children:"Right Click"})]})]})]})]}),(0,re.jsxs)(d.Flex,{alignItems:"center",justifyContent:"space-between",children:[(0,re.jsx)(d.Text,{children:"Open in Emacs"}),(0,re.jsxs)(A.v2,{isLazy:!0,placement:"right",children:[(0,re.jsx)(A.j2,{as:h.Button,rightIcon:(0,re.jsx)(V.ChevronDownIcon,{}),colorScheme:"",color:"black",children:(0,re.jsx)(d.Text,{children:r.follow?r.follow[0].toUpperCase()+r.follow.slice(1):"Never"})}),(0,re.jsxs)(tt.h_,{children:[" ",(0,re.jsxs)(A.qy,{bgColor:"gray.200",zIndex:"popover",children:[(0,re.jsx)(A.sN,{onClick:function(){return o(wn(wn({},r),{},{follow:""}))},children:"Never"}),(0,re.jsx)(A.sN,{onClick:function(){return o(wn(wn({},r),{},{follow:"click"}))},children:"Click"}),(0,re.jsx)(A.sN,{onClick:function(){return o(wn(wn({},r),{},{follow:"double"}))},children:"Double Click"}),(0,re.jsx)(A.sN,{onClick:function(){return o(wn(wn({},r),{},{follow:"right"}))},children:"Right Click"})]})]})]})]}),(0,re.jsxs)(d.Flex,{alignItems:"center",justifyContent:"space-between",children:[(0,re.jsx)(d.Text,{children:"Follow Emacs by..."}),(0,re.jsxs)(A.v2,{isLazy:!0,placement:"right",children:[(0,re.jsx)(A.j2,{as:h.Button,rightIcon:(0,re.jsx)(V.ChevronDownIcon,{}),colorScheme:"",color:"black",children:(0,re.jsx)(d.Text,{children:t.follow[0].toUpperCase()+t.follow.slice(1)})}),(0,re.jsxs)(tt.h_,{children:[" ",(0,re.jsxs)(A.qy,{bgColor:"gray.200",zIndex:"popover",children:[(0,re.jsx)(A.sN,{onClick:function(){return n(wn(wn({},t),{},{follow:"color"}))},children:"Just coloring the currently opened node"}),(0,re.jsx)(A.sN,{onClick:function(){return n(wn(wn({},t),{},{follow:"local"}))},children:"Opening the local graph"}),(0,re.jsx)(A.sN,{onClick:function(){return n(wn(wn({},t),{},{follow:"zoom"}))},children:"Zooming to the current node"})]})]})]})]}),(0,re.jsxs)(d.Flex,{alignItems:"center",justifyContent:"space-between",children:[(0,re.jsxs)(d.Flex,{children:[(0,re.jsx)(d.Text,{children:"Local graph"}),(0,re.jsx)(dn,{infoText:"When in local mode and clicking a new node, should I add that node's local graph or open the new one?"})]}),(0,re.jsxs)(A.v2,{isLazy:!0,placement:"right",children:[(0,re.jsx)(A.j2,{as:h.Button,rightIcon:(0,re.jsx)(V.ChevronDownIcon,{}),colorScheme:"",color:"black",children:(0,re.jsx)(d.Text,{children:"add"===t.localSame?"Add":"Replace"})}),(0,re.jsxs)(tt.h_,{children:[" ",(0,re.jsxs)(A.qy,{bgColor:"gray.200",zIndex:"popover",children:[(0,re.jsx)(A.sN,{onClick:function(){return n(wn(wn({},t),{},{localSame:"replace"}))},children:"Open that nodes graph"}),(0,re.jsx)(A.sN,{onClick:function(){return n(wn(wn({},t),{},{localSame:"add"}))},children:"Add node to local graph"})]})]})]})]}),(0,re.jsx)(hn,{label:"Zoom speed",value:t.zoomSpeed,min:0,max:4e3,step:100,onChange:function(e){return n(wn(wn({},t),{},{zoomSpeed:e}))}}),(0,re.jsx)(hn,{label:"Zoom padding",value:t.zoomPadding,min:0,max:400,step:1,onChange:function(e){return n(wn(wn({},t),{},{zoomPadding:e}))},infoText:"How much to zoom out to accomodate all nodes when changing the view."})]})},On=n(11391);function Sn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function In(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sn(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Nn=function(e){var t=e.visuals,n=e.setVisuals;return(0,re.jsx)(d.VStack,{spacing:2,justifyContent:"flex-start",divider:(0,re.jsx)(d.StackDivider,{borderColor:"gray.500"}),align:"stretch",color:"gray.800",children:(0,re.jsx)(d.Box,{children:(0,re.jsx)(vn,{label:"Highlight",onChange:function(){return n((function(e){return In(In({},e),{},{highlight:!e.highlight})}))},value:t.highlight,children:(0,re.jsxs)(d.VStack,{spacing:1,justifyContent:"flex-start",divider:(0,re.jsx)(d.StackDivider,{borderColor:"gray.400"}),align:"stretch",paddingLeft:0,children:[(0,re.jsx)(hn,{label:"Highlight Link Thickness",value:t.highlightLinkSize,onChange:function(e){return n((function(t){return In(In({},t),{},{highlightLinkSize:e})}))}}),(0,re.jsx)(hn,{label:"Highlight Node Size",value:t.highlightNodeSize,onChange:function(e){return n((function(t){return In(In({},t),{},{highlightNodeSize:e})}))}}),(0,re.jsx)(hn,{min:0,max:1,label:"Highlight Fade",value:t.highlightFade,onChange:function(e){return n((function(t){return In(In({},t),{},{highlightFade:e})}))}}),(0,re.jsxs)(vn,{label:"Highlight Animation",onChange:function(){n((function(e){return In(In({},e),{},{highlightAnim:!e.highlightAnim})}))},value:t.highlightAnim,children:[(0,re.jsx)(hn,{label:"Animation speed",onChange:function(e){return n((function(t){return In(In({},t),{},{animationSpeed:e})}))},value:t.animationSpeed,infoText:"Slower speed has a chance of being buggy",min:50,max:1e3,step:10}),(0,re.jsx)(On.Ph,{placeholder:t.algorithmName,onChange:function(e){n((function(t){return In(In({},t),{},{algorithmName:e.target.value})}))},children:t.algorithmOptions.map((function(e){return(0,re.jsx)("option",{value:e,children:e},e)}))})]})]})})})})};function Pn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Bn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pn(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Dn=function(e){var t=e.label,n=e.colorList,r=e.value,o=e.visValue,l=e.setVisuals,s=e.noEmpty,c=(0,v.useCallback)((function(e){return l((function(t){return Bn(Bn({},t),{},(0,i.Z)({},r,e))}))}),[]);return(0,re.jsxs)(d.Flex,{alignItems:"center",justifyContent:"space-between",children:[(0,re.jsx)(d.Text,{children:t}),(0,re.jsxs)(et.J2,{isLazy:!0,placement:"right",children:[(0,re.jsx)(et.xo,{children:(0,re.jsx)(h.Button,{colorScheme:"",color:"black",rightIcon:(0,re.jsx)(V.ChevronDownIcon,{}),children:(0,re.jsx)(d.Box,{bgColor:o,borderRadius:"sm",height:6,width:6})})}),(0,re.jsx)(tt.h_,{children:(0,re.jsx)(et.yk,{zIndex:"tooltip",maxW:36,position:"relative",children:(0,re.jsxs)(d.Flex,{flexWrap:"wrap",bgColor:"gray.200",children:[!s&&(0,re.jsx)(d.Box,{onClick:function(){return c("")},justifyContent:"space-between",alignItems:"center",display:"flex",m:1,children:(0,re.jsx)(d.Box,{height:6,width:6,borderColor:"gray.600",borderRadius:"xl",borderWidth:1})}),n.map((function(e){return(0,re.jsx)(d.Box,{m:1,onClick:function(){return c(e)},justifyContent:"space-between",alignItems:"center",display:"flex",children:(0,re.jsx)(d.Box,{bgColor:e,borderRadius:"xl",height:6,width:6})},e)}))]})})})]})]})};function Ln(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ln(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ln(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Tn=function(e){var t=e.visuals,n=e.setVisualsCallback,r=e.highlightColor,i=e.setHighlightColor;return(0,re.jsx)(d.VStack,{spacing:2,justifyContent:"flex-start",divider:(0,re.jsx)(d.StackDivider,{borderColor:"gray.500"}),align:"stretch",color:"gray.800",children:(0,re.jsxs)(d.Box,{children:[(0,re.jsxs)(d.Flex,{alignItems:"center",justifyContent:"space-between",children:[(0,re.jsx)(d.Text,{children:"Nodes"}),(0,re.jsx)(u.u,{label:"Shuffle node colors",children:(0,re.jsx)(h.IconButton,{"aria-label":"Shuffle node colors",size:"sm",icon:(0,re.jsx)(V.RepeatIcon,{}),variant:"ghost",onClick:function(){var e,r=null!==(e=t.nodeColorScheme)&&void 0!==e?e:[];n(Fn(Fn({},t),{},{nodeColorScheme:r.map((function(e){return[Math.random(),e]})).sort((function(e,t){return(0,l.Z)(e,1)[0]-(0,l.Z)(t,1)[0]})).map((function(e){var t=(0,l.Z)(e,2);t[0];return t[1]}))}))}})}),(0,re.jsx)(u.u,{label:"Cycle node colors",children:(0,re.jsx)(h.IconButton,{"aria-label":"Shift node colors",icon:(0,re.jsx)(V.ArrowRightIcon,{}),size:"sm",variant:"ghost",onClick:function(){var e,r=null!==(e=t.nodeColorScheme)&&void 0!==e?e:[];n(Fn(Fn({},t),{},{nodeColorScheme:[].concat((0,o.Z)(r.slice(1,r.length)),[r[0]])}))}})}),(0,re.jsxs)(A.v2,{isLazy:!0,placement:"right",closeOnSelect:!1,matchWidth:!0,children:[(0,re.jsx)(A.j2,{width:20,as:h.Button,colorScheme:"",color:"black",rightIcon:(0,re.jsx)(V.ChevronDownIcon,{}),children:(0,re.jsx)(d.Flex,{height:6,width:6,flexDirection:"column",flexWrap:"wrap",children:t.nodeColorScheme.map((function(e){return(0,re.jsx)(d.Box,{bgColor:e,flex:"1 1 8px",borderRadius:"2xl"},e)}))})}),(0,re.jsxs)(tt.h_,{children:[" ",(0,re.jsx)(A.qy,{minW:10,zIndex:"popover",bgColor:"gray.200",children:(0,re.jsx)(A.__,{width:500,type:"checkbox",defaultValue:t.nodeColorScheme,onChange:function(e){e.length&&n(Fn(Fn({},t),{},{nodeColorScheme:e}))},children:W.map((function(e){return(0,re.jsx)(A.ii,{isChecked:t.nodeColorScheme.some((function(t){return t===e})),value:e,isDisabled:1===t.nodeColorScheme.length&&t.nodeColorScheme[0]===e,children:(0,re.jsx)(d.Box,{justifyContent:"space-between",alignItems:"center",display:"flex",children:(0,re.jsx)(d.Box,{bgColor:e,borderRadius:"sm",height:6,width:6})})},e)}))})})]})]})]}),(0,re.jsxs)(d.Flex,{alignItems:"center",justifyContent:"space-between",children:[(0,re.jsx)(d.Text,{children:"Links"}),(0,re.jsxs)(A.v2,{isLazy:!0,placement:"right",children:[(0,re.jsx)(A.j2,{as:h.Button,colorScheme:"",color:"black",rightIcon:(0,re.jsx)(V.ChevronDownIcon,{}),children:(0,re.jsx)(d.Box,{children:t.linkColorScheme?(0,re.jsx)(d.Box,{bgColor:t.linkColorScheme,borderRadius:"sm",height:6,width:6}):(0,re.jsx)(d.Flex,{height:6,width:6,flexDirection:"column",flexWrap:"wrap",children:t.nodeColorScheme.map((function(e){return(0,re.jsx)(d.Box,{bgColor:e,flex:"1 1 8px",borderRadius:"2xl"},e)}))})})}),(0,re.jsxs)(tt.h_,{children:[" ",(0,re.jsxs)(A.qy,{minW:10,zIndex:"popover",bgColor:"gray.200",children:[(0,re.jsx)(A.sN,{onClick:function(){return n(Fn(Fn({},t),{},{linkColorScheme:""}))},justifyContent:"space-between",alignItems:"center",display:"flex",children:(0,re.jsx)(d.Flex,{height:6,width:6,flexDirection:"column",flexWrap:"wrap",children:t.nodeColorScheme.map((function(e){return(0,re.jsx)(d.Box,{bgColor:e,flex:"1 1 8px",borderRadius:"2xl"},e)}))})}),W.map((function(e){return(0,re.jsx)(A.sN,{onClick:function(){return n(Fn(Fn({},t),{},{linkColorScheme:e}))},justifyContent:"space-between",alignItems:"center",display:"flex",children:(0,re.jsx)(d.Box,{bgColor:e,borderRadius:"sm",height:6,width:6})},e)}))]})]})]})]}),(0,re.jsxs)(d.Flex,{alignItems:"center",justifyContent:"space-between",children:[(0,re.jsx)(d.Text,{children:"Accent"}),(0,re.jsxs)(A.v2,{isLazy:!0,placement:"right",children:[(0,re.jsx)(A.j2,{as:h.Button,colorScheme:"",color:"black",rightIcon:(0,re.jsx)(V.ChevronDownIcon,{}),children:(0,re.jsx)(d.Box,{bgColor:r,borderRadius:"sm",height:6,width:6})}),(0,re.jsxs)(tt.h_,{children:[" ",(0,re.jsx)(A.qy,{minW:10,zIndex:"popover",bgColor:"gray.200",children:W.map((function(e){return(0,re.jsx)(A.sN,{onClick:function(){return i(e)},justifyContent:"space-between",alignItems:"center",display:"flex",children:(0,re.jsx)(d.Box,{bgColor:e,borderRadius:"sm",height:6,width:6})},e)}))})]})]})]}),(0,re.jsx)(Dn,{colorList:W,label:"Link highlight",setVisuals:n,value:"linkHighlight",visValue:t.linkHighlight}),(0,re.jsx)(Dn,{colorList:W,label:"Node highlight",setVisuals:n,value:"nodeHighlight",visValue:t.nodeHighlight}),(0,re.jsx)(Dn,{colorList:W,label:"Background",setVisuals:n,value:"backgroundColor",visValue:t.backgroundColor}),(0,re.jsx)(Dn,{colorList:W,label:"Emacs node",setVisuals:n,value:"emacsNodeColor",visValue:t.emacsNodeColor})]})})};function zn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function En(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zn(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Rn=function(e){var t=e.visuals,n=e.setVisuals,r=e.threeDim;return(0,re.jsx)(d.VStack,{spacing:2,justifyContent:"flex-start",divider:(0,re.jsx)(d.StackDivider,{borderColor:"gray.500"}),align:"stretch",color:"gray.800",children:(0,re.jsxs)(d.Box,{children:[(0,re.jsx)(hn,{label:"Node size",value:t.nodeRel,onChange:function(e){return n(En(En({},t),{},{nodeRel:e}))}}),(0,re.jsx)(hn,{label:"Node degree size multiplier",value:t.nodeSizeLinks,min:0,max:2,onChange:function(e){return n(En(En({},t),{},{nodeSizeLinks:e}))}}),(0,re.jsx)(hn,{label:"Node zoom invariance",value:t.nodeZoomSize,min:0,max:2,infoText:"How much the graph will try to keep the nodesize consistent across zoom scales. 0 is no consistency, node will always be their true size, 1 is linear, 2 is quadratic.",onChange:function(e){return n((function(t){return En(En({},t),{},{nodeZoomSize:e})}))}}),r&&(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(hn,{label:"Node opacity",value:t.nodeOpacity,min:0,max:1,onChange:function(e){return n(En(En({},t),{},{nodeOpacity:e}))}}),(0,re.jsx)(hn,{label:"Node resolution",value:t.nodeResolution,min:5,max:32,step:1,onChange:function(e){return n(En(En({},t),{},{nodeResolution:e}))}})]}),(0,re.jsx)(hn,{label:"Link width",value:t.linkWidth,onChange:function(e){return n(En(En({},t),{},{linkWidth:e}))}}),r&&(0,re.jsx)(hn,{label:"Link opacity",min:0,max:1,value:t.linkOpacity,onChange:function(e){return n(En(En({},t),{},{linkOpacity:e}))}}),(0,re.jsxs)(vn,{label:"Link arrows",value:t.arrows,onChange:function(){return n(En(En({},t),{},{arrows:!t.arrows}))},children:[(0,re.jsx)(hn,{label:"Arrow size",value:t.arrowsLength/10,onChange:function(e){return n(En(En({},t),{},{arrowsLength:10*e}))}}),(0,re.jsx)(hn,{label:"Arrow Position",value:t.arrowsPos,min:0,max:1,step:.01,onChange:function(e){return n(En(En({},t),{},{arrowsPos:e}))}}),(0,re.jsx)(Dn,{colorList:W,label:"Arrow Color",setVisuals:n,value:"arrowsColor",visValue:t.arrowsColor},"arrow")]}),(0,re.jsxs)(vn,{label:"Directional Particles",value:t.particles,onChange:function(){return n(En(En({},t),{},{particles:!t.particles}))},children:[(0,re.jsx)(hn,{label:"Particle Number",value:t.particlesNumber,max:5,step:1,onChange:function(e){return n(En(En({},t),{},{particlesNumber:e}))}}),(0,re.jsx)(hn,{label:"Particle Size",value:t.particlesWidth,onChange:function(e){return n(En(En({},t),{},{particlesWidth:e}))}})]})]})})};function Zn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Hn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zn(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Wn=function(e){var t=e.visuals,n=e.setVisuals;return(0,re.jsxs)(d.VStack,{spacing:2,justifyContent:"flex-start",divider:(0,re.jsx)(d.StackDivider,{borderColor:"gray.400"}),align:"stretch",color:"gray.800",children:[(0,re.jsxs)(d.Flex,{alignItems:"center",justifyContent:"space-between",children:[(0,re.jsx)(d.Text,{children:"Show labels"}),(0,re.jsxs)(A.v2,{isLazy:!0,placement:"right",children:[(0,re.jsx)(A.j2,{as:h.Button,colorScheme:"",color:"black",rightIcon:(0,re.jsx)(V.ChevronDownIcon,{}),children:t.labels?t.labels<2?"On Highlight":"Always":"Never"}),(0,re.jsxs)(tt.h_,{children:[" ",(0,re.jsxs)(A.qy,{zIndex:"popover",bgColor:"gray.200",children:[(0,re.jsx)(A.sN,{onClick:function(){return n(Hn(Hn({},t),{},{labels:0}))},children:"Never"}),(0,re.jsx)(A.sN,{onClick:function(){return n(Hn(Hn({},t),{},{labels:1}))},children:"On Highlight"}),(0,re.jsx)(A.sN,{onClick:function(){return n(Hn(Hn({},t),{},{labels:2}))},children:"Always"}),(0,re.jsx)(A.sN,{onClick:function(){return n(Hn(Hn({},t),{},{labels:3}))},children:"Always (even in 3D)"})]})]})]})]}),(0,re.jsxs)(jn.UO,{in:t.labels>1,animateOpacity:!0,children:[(0,re.jsx)(d.Box,{paddingTop:2,children:(0,re.jsx)(hn,{label:"Label Appearance Scale",value:2*t.labelScale,onChange:function(e){return n(Hn(Hn({},t),{},{labelScale:e/2}))}})}),(0,re.jsxs)(d.Box,{paddingTop:2,children:[(0,re.jsx)(hn,{label:"Label dynamicity",infoText:"By default, labels of nodes with more links will appear earlier than those with fewer. This slider changes the strength of this effect, put it at zero to disable it.",value:t.labelDynamicStrength,min:0,max:1,step:.05,onChange:function(e){return n((function(t){return Hn(Hn({},t),{},{labelDynamicStrength:e})}))}}),(0,re.jsx)(jn.UO,{in:t.labelDynamicStrength>0,children:(0,re.jsx)(hn,{label:"Dynamic zoom degree cap",infoText:"The maximum number of links that is considered for the 'dynamic zoom effect'. Past this number all number of links are treated the same.",value:t.labelDynamicDegree,min:1,max:15,step:1,onChange:function(e){return n((function(t){return Hn(Hn({},t),{},{labelDynamicDegree:e})}))}})})]})]}),(0,re.jsx)(Dn,{colorList:W,label:"Text",setVisuals:n,value:"labelTextColor",visValue:t.labelTextColor}),(0,re.jsxs)(d.Box,{children:[(0,re.jsx)(Dn,{colorList:W,label:"Background",setVisuals:n,value:"labelBackgroundColor",visValue:t.labelBackgroundColor}),(0,re.jsx)(jn.UO,{in:!!t.labelBackgroundColor,animateOpacity:!0,children:(0,re.jsx)(d.Box,{paddingTop:2,children:(0,re.jsx)(hn,{label:"Background opacity",value:t.labelBackgroundOpacity,onChange:function(e){console.log(t.labelBackgroundOpacity),n(Hn(Hn({},t),{},{labelBackgroundOpacity:e}))},min:0,max:1,step:.01})})})]}),(0,re.jsx)(hn,{label:"Label font size",value:t.labelFontSize,min:5,max:20,step:.5,onChange:function(e){return n(Hn(Hn({},t),{},{labelFontSize:e}))}}),(0,re.jsx)(hn,{label:"Max. label characters",value:t.labelLength,min:10,max:100,step:1,onChange:function(e){return n(Hn(Hn({},t),{},{labelLength:e}))}}),(0,re.jsx)(hn,{label:"Max. label line length",value:t.labelWordWrap,min:10,max:100,step:1,onChange:function(e){return n(Hn(Hn({},t),{},{labelWordWrap:e}))}}),(0,re.jsx)(hn,{label:"Space between label lines",value:t.labelLineSpace,min:.2,max:3,step:.1,onChange:function(e){return n(Hn(Hn({},t),{},{labelLineSpace:e}))}})]})},An=n(67690),Mn=function(){var e=(0,v.useContext)(nt.N),t=e.emacsTheme,n=e.setEmacsTheme;e.highlightColor;return(0,re.jsxs)(d.Flex,{alignItems:"center",justifyContent:"space-between",pl:7,pr:2,children:[(0,re.jsx)(d.Text,{children:"Theme"}),(0,re.jsxs)(A.v2,{isLazy:!0,placement:"bottom",closeOnSelect:!1,children:[(0,re.jsx)(A.j2,{as:h.Button,size:"sm",colorScheme:"",color:"black",rightIcon:(0,re.jsx)(V.ChevronDownIcon,{}),children:t[0]}),(0,re.jsxs)(A.qy,{minW:10,zIndex:"popover",bgColor:"gray.200",children:[(0,re.jsx)(A.sN,{onClick:function(){return""},justifyContent:"space-between",alignItems:"center",display:"flex",children:(0,re.jsx)(d.Box,{height:6,width:6})}),Object.keys(An.n).map((function(e,t){return(0,re.jsxs)(A.sN,{onClick:function(){return n([e,An.n[e]])},justifyContent:"space-between",alignItems:"center",display:"flex",children:[(0,re.jsx)(d.Text,{children:e}),(0,re.jsx)(d.Flex,{height:6,width:20,flexDirection:"column",flexWrap:"wrap",children:Object.values(An.n[e]).map((function(e){return(0,re.jsx)(d.Box,{bgColor:e,flex:"1 1 8px"},e)}))})]},e)}))]})]})]})};function Vn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vn(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Un=function(e){var t=e.visuals,n=e.setVisuals;return(0,re.jsx)(d.VStack,{spacing:2,justifyContent:"flex-start",divider:(0,re.jsx)(d.StackDivider,{borderColor:"gray.500"}),align:"stretch",color:"gray.800",children:(0,re.jsxs)(d.Box,{children:[(0,re.jsxs)(vn,{label:"Dash cite links",infoText:"Add dashes to citation links made with org-roam-bibtex",value:t.citeDashes,onChange:function(){return n(_n(_n({},t),{},{citeDashes:!t.citeDashes}))},children:[(0,re.jsx)(hn,{label:"Dash length",value:t.citeDashLength/10,onChange:function(e){return n(_n(_n({},t),{},{citeDashLength:10*e}))}}),(0,re.jsx)(hn,{label:"Gap length",value:t.citeGapLength/5,onChange:function(e){return n(_n(_n({},t),{},{citeGapLength:5*e}))}})]}),(0,re.jsx)(Dn,{colorList:W,label:"Citation node color",setVisuals:n,value:"citeNodeColor",visValue:t.citeNodeColor}),(0,re.jsx)(Dn,{colorList:W,label:"Citation link color",setVisuals:n,value:"citeLinkColor",visValue:t.citeLinkColor}),(0,re.jsx)(Dn,{colorList:W,label:"Reference link highlight",setVisuals:n,value:"citeLinkHighlightColor",visValue:t.citeLinkHighlightColor}),(0,re.jsxs)(vn,{label:"Dash ref links",infoText:"Add dashes to citation links, whose target has a note, made with org-roam-bibtex",value:t.refDashes,onChange:function(){return n(_n(_n({},t),{},{refDashes:!t.refDashes}))},children:[(0,re.jsx)(hn,{label:"Dash length",value:t.refDashLength/10,onChange:function(e){return n(_n(_n({},t),{},{refDashLength:10*e}))}}),(0,re.jsx)(hn,{label:"Gap length",value:t.refGapLength/5,onChange:function(e){return n(_n(_n({},t),{},{refGapLength:5*e}))}})]}),(0,re.jsx)(Dn,{colorList:W,label:"Reference node color",setVisuals:n,value:"refNodeColor",visValue:t.refNodeColor}),(0,re.jsx)(Dn,{colorList:W,label:"Reference link color",setVisuals:n,value:"refLinkColor",visValue:t.refLinkColor}),(0,re.jsx)(Dn,{colorList:W,label:"Reference link highlight",setVisuals:n,value:"refLinkHighlightColor",visValue:t.refLinkHighlightColor})]})})};function qn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qn(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Qn=function(e){var t=e.coloring,n=e.setColoring;return(0,re.jsxs)(d.Flex,{alignItems:"center",justifyContent:"space-between",pl:7,pr:2,children:[(0,re.jsx)(d.Text,{children:"Graph coloring"}),(0,re.jsxs)(A.v2,{isLazy:!0,placement:"right",children:[(0,re.jsx)(A.j2,{as:h.Button,size:"sm",colorScheme:"",color:"black",rightIcon:(0,re.jsx)(V.ChevronDownIcon,{}),children:"degree"===t.method?"Links":"Communities"}),(0,re.jsx)(tt.h_,{children:(0,re.jsxs)(A.qy,{minW:10,zIndex:"popover",bgColor:"gray.200",children:[(0,re.jsx)(A.sN,{onClick:function(){return n((function(e){return Xn(Xn({},e),{},{method:"degree"})}))},justifyContent:"space-between",alignItems:"center",display:"flex",children:"Number of links"}),(0,re.jsx)(A.sN,{onClick:function(){return n((function(e){return Xn(Xn({},e),{},{method:"community"})}))},justifyContent:"space-between",alignItems:"center",display:"flex",children:"Communities"})]})})]})]})},Gn=function(e){var t=e.coloring,n=e.setColoring,r=e.visuals,o=e.setVisuals,i=e.highlightColor,l=e.setHighlightColor,s=e.threeDim,c=(0,v.useCallback)((function(e){return o(e)}),[]);return(0,re.jsxs)(d.VStack,{justifyContent:"flex-start",align:"stretch",children:[(0,re.jsx)(Mn,{}),(0,re.jsx)(Qn,{coloring:t,setColoring:n}),(0,re.jsxs)(Wt.UQ,{allowToggle:!0,defaultIndex:[0],paddingLeft:3,children:[(0,re.jsxs)(Wt.Qd,{children:[(0,re.jsx)(Wt.KF,{children:(0,re.jsxs)(d.Flex,{justifyContent:"space-between",w:"100%",children:[(0,re.jsx)(d.Text,{children:"Colors"}),(0,re.jsx)(Wt.XE,{marginRight:2})]})}),(0,re.jsx)(Wt.Hk,{children:(0,re.jsx)(Tn,{visuals:r,setVisualsCallback:c,highlightColor:i,setHighlightColor:l})})]}),(0,re.jsxs)(Wt.Qd,{children:[(0,re.jsx)(Wt.KF,{children:(0,re.jsxs)(d.Flex,{justifyContent:"space-between",w:"100%",children:[(0,re.jsx)(d.Text,{children:"Nodes & Links"}),(0,re.jsx)(Wt.XE,{marginRight:2})]})}),(0,re.jsx)(Wt.Hk,{children:(0,re.jsx)(Rn,{visuals:r,setVisuals:c,threeDim:s})})]}),(0,re.jsxs)(Wt.Qd,{children:[(0,re.jsx)(Wt.KF,{children:(0,re.jsxs)(d.Flex,{justifyContent:"space-between",w:"100%",children:[(0,re.jsx)(d.Text,{children:"Labels"}),(0,re.jsx)(Wt.XE,{marginRight:2})]})}),(0,re.jsx)(Wt.Hk,{children:(0,re.jsx)(Wn,{visuals:r,setVisuals:c})})]}),(0,re.jsxs)(Wt.Qd,{children:[(0,re.jsx)(Wt.KF,{children:(0,re.jsxs)(d.Flex,{justifyContent:"space-between",w:"100%",children:[(0,re.jsx)(d.Text,{children:"Highlighting"}),(0,re.jsx)(Wt.XE,{marginRight:2})]})}),(0,re.jsx)(Wt.Hk,{children:(0,re.jsx)(Nn,{visuals:r,setVisuals:c})})]}),(0,re.jsxs)(Wt.Qd,{children:[(0,re.jsx)(Wt.KF,{children:(0,re.jsxs)(d.Flex,{justifyContent:"space-between",w:"100%",children:[(0,re.jsx)(d.Text,{children:"Citations"}),(0,re.jsx)(Wt.XE,{marginRight:2})]})}),(0,re.jsx)(Wt.Hk,{children:(0,re.jsx)(Un,{visuals:r,setVisuals:c})})]})]})]})},Kn=["style"];function $n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Jn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$n(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$n(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Yn=function(e){var t=e.physics,n=e.setPhysics,r=e.threeDim,o=e.setThreeDim,i=e.filter,s=e.setFilter,c=e.visuals,a=e.setVisuals,g=e.mouse,f=e.setMouse,p=e.behavior,x=e.setBehavior,j=e.tags,b=e.linktags,m=e.tagColors,y=e.setTagColors,C=e.linktagColors,w=e.setLinkTagColors,k=e.coloring,O=e.setColoring,S=e.local,I=e.setLocal,N=Tt("showTweaks",!1),P=(0,l.Z)(N,2),B=P[0],D=P[1],L=(0,v.useContext)(nt.N),A=L.highlightColor,M=L.setHighlightColor;return B?(0,re.jsxs)(d.Box,{position:"absolute",bg:"alt.100",w:"xs",marginTop:2,marginLeft:2,borderRadius:"lg",paddingBottom:5,zIndex:10,boxShadow:"xl",maxH:"95vh",fontSize:"sm",children:[(0,re.jsxs)(d.Box,{display:"flex",justifyContent:"space-between",alignItems:"center",paddingRight:2,paddingTop:1,children:[(0,re.jsx)(u.u,{label:"2D",children:(0,re.jsx)(h.Button,{onClick:function(){return o(!r)},variant:"subtle",zIndex:"overlay",children:r?"3D":"2D"})}),(0,re.jsxs)(d.Box,{display:"flex",alignItems:"center",children:[(0,re.jsx)(u.u,{label:"Reset settings to defaults",children:(0,re.jsx)(h.IconButton,{"aria-label":"Reset Defaults",icon:(0,re.jsx)(V.RepeatClockIcon,{}),onClick:function(){a(E),s(T),f(Z),n(F),x(R),O(z),M("purple.500"),I(H)},variant:"subtle",size:"sm"})}),(0,re.jsx)(h.IconButton,{size:"sm",icon:(0,re.jsx)(V.CloseIcon,{}),"aria-label":"Close Tweak Panel",variant:"subtle",onClick:function(){return D(!1)}})]})]}),(0,re.jsx)(lt.ZP,{autoHeight:!0,autoHeightMax:.85*globalThis.innerHeight,autoHide:!0,renderThumbVertical:function(e){var t=e.style,n=(0,q.Z)(e,Kn);return(0,re.jsx)(d.Box,Jn(Jn({},n),{},{style:Jn(Jn({},t),{},{borderRadius:10}),bg:A}))},children:(0,re.jsxs)(Wt.UQ,{allowMultiple:!0,allowToggle:!0,color:"black",children:[(0,re.jsxs)(Wt.Qd,{children:[(0,re.jsxs)(Wt.KF,{children:[(0,re.jsx)(Wt.XE,{marginRight:2}),(0,re.jsx)(d.Heading,{size:"sm",children:"Filter"})]}),(0,re.jsx)(Wt.Hk,{children:(0,re.jsx)(xn,{filter:i,setFilter:s,tagColors:m,setTagColors:y,linktagColors:C,setLinkTagColors:w,highlightColor:A,colorList:W,tags:j,linktags:b,local:S,setLocal:I})})]}),(0,re.jsxs)(Wt.Qd,{children:[(0,re.jsx)(Wt.KF,{display:"flex",justifyContent:"space-between",children:(0,re.jsxs)(d.Box,{display:"flex",children:[(0,re.jsx)(Wt.XE,{marginRight:2}),(0,re.jsx)(d.Heading,{size:"sm",children:"Physics"})]})}),(0,re.jsx)(Wt.Hk,{children:(0,re.jsx)(yn,{physics:t,setPhysics:n})})]}),(0,re.jsxs)(Wt.Qd,{children:[(0,re.jsxs)(Wt.KF,{children:[(0,re.jsx)(Wt.XE,{marginRight:2}),(0,re.jsx)(d.Heading,{size:"sm",children:"Visual"})]}),(0,re.jsx)(Wt.Hk,{children:(0,re.jsx)(Gn,{visuals:c,setVisuals:a,highlightColor:A,setHighlightColor:M,threeDim:r,coloring:k,setColoring:O})})]}),(0,re.jsxs)(Wt.Qd,{children:[(0,re.jsxs)(Wt.KF,{children:[(0,re.jsx)(Wt.XE,{marginRight:2}),(0,re.jsx)(d.Heading,{size:"sm",children:"Behavior"})]}),(0,re.jsx)(Wt.Hk,{children:(0,re.jsx)(kn,{behavior:p,setBehavior:x,mouse:g,setMouse:f})})]})]})})]}):(0,re.jsx)(d.Box,{position:"absolute",zIndex:"overlay",marginTop:1,marginLeft:0,display:B?"none":"block",children:(0,re.jsx)(h.IconButton,{variant:"subtle","aria-label":"Settings",icon:(0,re.jsx)(V.SettingsIcon,{}),onClick:function(){return D(!0)}})})},er=n(22663),tr=n.n(er),nr=n(94244),rr=function(e){var t,n=e.linksByNodeId,r=e.visuals,o=e.highlightedNodes,i=e.previouslyHighlightedNodes,l=e.opacity,s=e.node,c=null!==(t=n[s.id])&&void 0!==t?t:[],a=c.length?c.filter((function(e){return"parent"===e.type})).length:0,d=3+c.length*r.nodeSizeLinks-(nr.hX.parent?0:a);return 1===r.highlightNodeSize?d:d*(o[s.id]||i[s.id]?1+l*(r.highlightNodeSize-1):1)};function or(e,t){return"rgba("+(e=e.replace("#","")).match(new RegExp("(.{"+e.length/3+"})","g")).map((function(t){return parseInt(e.length%2?t+t:t,16)})).concat(isFinite(t)?t:1).join(",")+")"}function ir(e){var t,n,r,i,l=e.labelBackgroundColor,s=e.labelTextColor,c=e.node,a=e.ctx,d=e.globalScale,u=e.highlightedNodes,h=e.previouslyHighlightedNodes,g=e.visuals,f=e.opacity,p=e.filteredLinksByNodeId,x=(e.nodeRel,e.hoverNode),j=e.lastHoverNode;if(c&&g.labels){var v=null!==(t=null===x||void 0===x?void 0:x.id)&&void 0!==t?t:"",b=null!==(n=null===j||void 0===j?void 0:j.id)&&void 0!==n?n:"",m=null!==(r=p[c.id])&&void 0!==r?r:[],y=!(!u[c.id]&&!h[c.id]),C=Math.min(5*(d-g.labelScale)+2*Math.pow(Math.min(m.length,g.labelDynamicDegree),g.labelDynamicStrength),1);if(!(C<.01)||y){var w=null!==(i=c.title)&&void 0!==i?i:"",k=w.substring(0,g.labelLength),O=Math.cbrt(g.nodeRel*rr({node:c,highlightedNodes:u,linksByNodeId:p,opacity:f,previouslyHighlightedNodes:h,visuals:g})/Math.pow(d,g.nodeZoomSize)),S=g.labelFontSize/Math.cbrt(Math.pow(d,g.nodeZoomSize)),I=[1.1*a.measureText(k).width,S].map((function(e){return e+.5*S})),N=function(e,t,n,r,o){return o?Math.max(e,r):1*e*(-1*(t.highlightFade*r-1))}(C,g,0,f,y);if(g.labelBackgroundColor&&g.labelBackgroundOpacity){var P=or(l,N*g.labelBackgroundOpacity);a.fillStyle=P,a.fillRect.apply(a,[c.x-I[0]/2,c.y-I[1]/2+O].concat((0,o.Z)(I)))}a.textAlign="center",a.textBaseline="middle";var B=or(s,N);a.fillStyle=B,a.font="".concat(S,"px Sans-Serif");var D=tr()(k,{width:g.labelWordWrap}).split("\n"),L=w.length>g.labelLength?[].concat((0,o.Z)(D.slice(0,-1)),["".concat(D.slice(-1),"...")]):D,F=[v,b].includes(c.id)?1+.3*f:1;L.forEach((function(e,t){a.fillText(e,c.x,c.y+F*O*8+g.labelLineSpace*S*t)}))}}}var lr=function(e){var t,n,r,o,i,l=e.id,s=e.linksByNodeId,c=e.visuals,a=e.coloring,d=e.cluster,u=null!==(t=null===(n=s[l])||void 0===n?void 0:n.length)&&void 0!==t?t:0;return"degree"===a.method?c.nodeColorScheme[(r=u,o=0,i=c.nodeColorScheme.length-1,Math.min(Math.max(r,o),i))]:c.nodeColorScheme[u&&d[l]%c.nodeColorScheme.length]},sr=function(e,t){var n,r;return(null===(n=e.source)||void 0===n?void 0:n.id)===(null===t||void 0===t?void 0:t.id)||(null===(r=e.target)||void 0===r?void 0:r.id)===(null===t||void 0===t?void 0:t.id)},cr=function(e){var t=e.sourceId,n=e.targetId,r=e.linksByNodeId,o=e.visuals,i=e.coloring,l=e.cluster;return r[t].length>r[n].length?lr({id:t,linksByNodeId:r,visuals:o,cluster:l,coloring:i}):lr({id:n,visuals:o,linksByNodeId:r,cluster:l,coloring:i})};function ar(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ar(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ar(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ur=n.e(907).then(n.bind(n,99907)),hr=n.g.window?n(24878).f$:null,gr=n.g.window?n(24878).s6:null;function fr(){var e=(0,v.useState)(!1),t=e[0],n=e[1];return(0,v.useEffect)((function(){n(!0)}),[]),t?(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(j.default,{children:(0,re.jsx)("title",{children:"ORUI"})}),(0,re.jsx)(pr,{})]}):null}function pr(){var e=Tt("3d",!1),t=(0,l.Z)(e,2),n=t[0],r=t[1],s=Tt("tagCols",{}),c=(0,l.Z)(s,2),g=c[0],f=c[1],x=Tt("linktagCols",{}),j=(0,l.Z)(x,2),b=j[0],m=j[1],k=(0,v.useState)({nodeIds:[],excludedNodeIds:[]}),S=k[0],I=k[1],N=Tt("physics",F),P=(0,l.Z)(N,2),B=P[0],D=P[1],L=Tt("filter",T),W=(0,l.Z)(L,2),A=W[0],M=W[1],V=Tt("visuals",E),_=(0,l.Z)(V,2),U=_[0],q=_[1],X=(0,v.useState)(null),Q=X[0],G=X[1],K=(0,v.useState)(null),$=K[0],J=K[1],Y=Tt("behavior",R),ee=(0,l.Z)(Y,2),te=ee[0],ne=ee[1],oe=Tt("mouse",Z),ie=(0,l.Z)(oe,2),le=ie[0],se=ie[1],ce=Tt("coloring",z),ae=(0,l.Z)(ce,2),de=ae[0],ue=ae[1],he=Tt("local",H),ge=(0,l.Z)(he,2),pe=ge[0],xe=ge[1],je=(0,v.useState)([]),ve=je[0],be=je[1],me=(0,v.useState)([]),ye=me[0],Ce=me[1],we=(0,O.Z)({}),ke=(0,l.Z)(we,2),Oe=ke[0],Se=ke[1],Ie=Se.set,Ne=Se.reset,Pe=Se.undo,Be=Se.redo,De=Se.canUndo,Le=Se.canRedo,Fe=(Oe.past,Oe.present),Te=(Oe.future,(0,v.useState)(null)),ze=Te[0],Ee=Te[1],Re=(0,a.qY)(),Ze=Re.isOpen,He=Re.onOpen,We=Re.onClose,Ae=(0,a.qY)(),Me=Ae.isOpen,Ve=Ae.onOpen,_e=Ae.onClose,Ue=(0,v.useRef)({}),qe=(0,v.useRef)({}),Xe=(0,v.useRef)({}),Qe=(0,v.useRef)([]),Ge=(0,v.useRef)([]),Ke=(0,v.useRef)(null),$e=(0,v.useState)({}),Je=$e[0],et=$e[1],tt=(0,v.useRef)({}),rt=(0,v.useRef)({nodes:[],links:[]});(0,v.useEffect)((function(){Q&&(rt.current=Q)}),[Q]);var ot=(0,v.useContext)(nt.N).setEmacsTheme,it=(0,v.useRef)({nodeIds:[],excludedNodeIds:[]}),lt=(0,v.useRef)(R);lt.current=te;var st=(0,v.useRef)(null);it.current=S;var ct=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:200;if("color"!==e){var l=Ke.current,s=it.current,c=lt.current,a=null!==(n=qe.current[t])&&void 0!==n?n:[],d=Object.fromEntries([t].concat((0,o.Z)(a.flatMap((function(e){return[e.source,e.target]})))).map((function(e){return[e,{}]})));if("zoom"===e)return s.nodeIds.length&&I({nodeIds:[],excludedNodeIds:[]}),void setTimeout((function(){return l.zoomToFit(r,i,(function(e){return d[e.id]}))}),50);if(!s.nodeIds.length)return I((function(e){return dr(dr({},e),{},{nodeIds:[t]})})),void setTimeout((function(){l.centerAt(0,0,10),l.zoomToFit(1,i)}),50);if("add"!==c.localSame)return I((function(e){return dr(dr({},e),{},{nodeIds:[t]})})),void setTimeout((function(){l.centerAt(0,0,10),l.zoomToFit(1,i)}),50);if(!s.nodeIds.includes(t)||!s.nodeIds.some((function(e){return d[e]})))return I((function(e){return dr(dr({},e),{},{nodeIds:[t]})})),void setTimeout((function(){l.centerAt(0,0,10),l.zoomToFit(1,i)}),50);I((function(e){return dr(dr({},e),{},{nodeIds:[].concat((0,o.Z)(e.nodeIds),[t])})})),setTimeout((function(){l.centerAt(0,0,10),l.zoomToFit(1,i)}),50)}};(0,v.useEffect)((function(){st.current=new w.Z("ws://localhost:35903"),st.current.addEventListener("open",(function(){console.log("Connection with Emacs established")})),st.current.addEventListener("message",(function(e){var t=lt.current,n=JSON.parse(e.data);switch(n.type){case"graphdata":return function(e){var t,n,r,s=Ue.current;Qe.current=null!==(t=e.tags)&&void 0!==t?t:[];var c=null!==(n=e.nodes)&&void 0!==n?n:[],a=null!==(r=e.links)&&void 0!==r?r:[],d=c.reduce((function(e,t){var n;return dr(dr({},e),{},(0,i.Z)({},t.file,[].concat((0,o.Z)(null!==(n=e[t.file])&&void 0!==n?n:[]),[t])))}),{}),u=Object.keys(d).flatMap((function(e){var t,n=null!==(t=d[e])&&void 0!==t?t:[],r=n.find((function(e){return 0===e.level})),o=n.filter((function(e){return 0!==e.level}));return r?o.map((function(e){var t=n.filter((function(t){var n,r;return!(t.level>=e.level||t.pos>=e.pos||null===(n=e.olp)||void 0===n||!n.includes(null===(r=t.title)||void 0===r?void 0:r.replace(/ *\[\d*\/\d*\] */g,"")))})).reduce((function(e,t){return t.level>e.level&&(e=t),e}),r);return{source:(null===t||void 0===t?void 0:t.id)||r.id,target:e.id,type:"heading",properties:{outline:null,tag:"heading"}}})):[]})),h=Object.keys(d).flatMap((function(e){var t,n=null!==(t=d[e])&&void 0!==t?t:[],r=n.find((function(e){return 0===e.level})),o=n.filter((function(e){return 0!==e.level}));return r?o.map((function(e){return{source:e.id,target:r.id,type:"parent"}})):[]}));Ue.current=Object.fromEntries(c.map((function(e){return[e.id,e]})));var g=[].concat((0,o.Z)(a),(0,o.Z)(u),(0,o.Z)(h));Ge.current=g.reduce((function(e,t){var n;return null!==t&&void 0!==t&&null!==(n=t.properties)&&void 0!==n&&n.tag&&!e.some((function(e){var n;return e===(null===t||void 0===t||null===(n=t.properties)||void 0===n?void 0:n.tag)}))?e.concat(t.properties.tag):e}),[]);var f=[],p=g.map((function(e){var t=e.source,n=e.target;return Ue.current[t]?Ue.current[n]?e:(f.push({id:n,tags:["bad"],properties:{FILELESS:"yes",bad:"yes"},file:"",title:n,level:0,pos:0,olp:null}),dr(dr({},e),{},{type:"bad"})):(f.push({id:t,tags:["bad"],properties:{FILELESS:"yes",bad:"yes"},file:"",title:t,level:0,pos:0,olp:null}),dr(dr({},e),{},{type:"bad"}))}));Ue.current=dr(dr({},Ue.current),Object.fromEntries(f.map((function(e){return[e.id,e]})))),qe.current=p.reduce((function(e,t){var n,r,l;return dr(dr({},e),{},(l={},(0,i.Z)(l,t.source,[].concat((0,o.Z)(null!==(n=e[t.source])&&void 0!==n?n:[]),[t])),(0,i.Z)(l,t.target,[].concat((0,o.Z)(null!==(r=e[t.target])&&void 0!==r?r:[]),[t])),l))}),{});var x=[].concat((0,o.Z)(c),f);Xe.current=x.reduce((function(e,t){var n,r=null===(n=t.properties)||void 0===n?void 0:n.ROAM_REFS;if(null===r||void 0===r||!r.includes("cite"))return e;var o=r.replaceAll(/cite:(.*)/g,"$1");return o?dr(dr({},e),{},(0,i.Z)({},o,t)):e}),{});var j={nodes:x,links:p},v=rt.current;if(0===v.nodes.length){var b=JSON.parse(JSON.stringify(j));return rt.current=b,void G(b)}var m=[].concat((0,o.Z)(v.nodes.flatMap((function(e){var t,n=null!==(t=Ue.current[null===e||void 0===e?void 0:e.id])&&void 0!==t&&t;return n?[dr(dr({},e),n)]:[]}))),(0,o.Z)(Object.keys(Ue.current).filter((function(e){return!s[e]})).map((function(e){return Ue.current[e]})))),y=m.reduce((function(e,t,n){var r=null===t||void 0===t?void 0:t.id;return dr(dr({},e),{},(0,i.Z)({},r,n))}),{}),C=p.map((function(e){var t=yt(e),n=(0,l.Z)(t,2),r=n[0],o=n[1];return dr(dr({},e),{},{source:m[y[r]],target:m[y[o]]})}));G({nodes:m,links:C})}(n.data);case"variables":return et(n.data),void console.log(n);case"theme":return ot(["custom",n.data]);case"command":switch(n.data.commandName){case"local":var r=te.zoomSpeed,s=te.zoomPadding;ct("local",n.data.id,r,s),J(n.data.id);break;case"zoom":var c,a,d=(null===n||void 0===n||null===(c=n.data)||void 0===c?void 0:c.speed)||t.zoomSpeed,u=(null===n||void 0===n||null===(a=n.data)||void 0===a?void 0:a.padding)||t.zoomPadding;ct("zoom",n.data.id,d,u),J(n.data.id);break;case"follow":ct(t.follow,n.data.id,t.zoomSpeed,t.zoomPadding),J(n.data.id);break;case"change-local-graph":var h=Ue.current[n.data.id];if(!h)break;console.log(n),wt(h,n.data.manipulation);break;default:return console.error("unknown message type",n.type)}}}))}),[]),(0,v.useEffect)((function(){var e=Ke.current;!e||S.nodeIds.length>1||(S.nodeIds.length||!B.gravityOn?setTimeout((function(){e.zoomToFit(5,200)}),50):e.zoomToFit())}),[S.nodeIds]);var at=(0,p.iP)(),dt=(0,l.Z)(at,2),ut=dt[0],ht=dt[1],gt=(0,v.useRef)(),ft=(0,v.useState)(null),pt=ft[0],xt=ft[1],jt=(0,v.useState)({left:0,top:0,right:void 0,bottom:void 0}),vt=jt[0],bt=jt[1],mt=(0,a.qY)();(0,a.O3)({ref:gt,handler:function(){mt.onClose()}});var Ct=function(e,t,n){bt(n||{left:t.pageX,top:t.pageY,right:void 0,bottom:void 0}),xt(e),mt.onOpen()},wt=function(e,t){"remove"!==t?"replace"!==t?S.nodeIds.includes(e.id)||I((function(t){return{excludedNodeIds:t.excludedNodeIds.filter((function(t){return t!==e.id})),nodeIds:[].concat((0,o.Z)(t.nodeIds),[e.id])}})):I({nodeIds:[e.id],excludedNodeIds:[]}):I((function(t){return{nodeIds:t.nodeIds.filter((function(t){return t!==e.id})),excludedNodeIds:[].concat((0,o.Z)(t.excludedNodeIds),[e.id])}}))},kt=Tt("mainWindowWidth",ut),Ot=(0,l.Z)(kt,2),St=Ot[0],It=Ot[1];return(0,re.jsx)(Ye.Provider,{value:{layout:ve,setLayout:be},children:(0,re.jsx)(gn.Provider,{value:dr({},Je),children:(0,re.jsxs)(d.Box,{display:"flex",alignItems:"flex-start",flexDirection:"row",height:"100vh",overflow:"clip",children:[(0,re.jsx)(Yn,{physics:B,setPhysics:D,threeDim:n,setThreeDim:r,filter:A,setFilter:M,visuals:U,setVisuals:q,mouse:le,setMouse:se,behavior:te,setBehavior:ne,tagColors:g,setTagColors:f,linktagColors:b,setLinkTagColors:m,coloring:de,setColoring:ue,local:pe,setLocal:xe,tags:Qe.current,linktags:Ge.current}),(0,re.jsx)(d.Box,{position:"absolute",children:Q&&(0,re.jsx)(xr,{nodeById:Ue.current,linksByNodeId:qe.current,webSocket:st.current,variables:Je,physics:B,graphData:Q,threeDim:n,emacsNodeId:$,filter:A,visuals:U,behavior:te,mouse:le,scope:S,setScope:I,tagColors:g,linktagColors:b,setPreviewNode:Ie,sidebarHighlightedNode:ze,windowWidth:ut,windowHeight:ht,openContextMenu:Ct,contextMenu:mt,handleLocal:wt,mainWindowWidth:St,setMainWindowWidth:It,setContextMenuTarget:xt,graphRef:Ke,clusterRef:tt,coloring:de,local:pe})}),(0,re.jsx)(d.Box,{position:"relative",zIndex:4,width:"100%",children:(0,re.jsx)(d.Flex,{className:"headerBar",h:10,flexDir:"column",children:(0,re.jsx)(d.Flex,{alignItems:"center",h:10,justifyContent:"flex-end",children:(0,re.jsxs)(d.Flex,{height:"100%",flexDirection:"row",children:[S.nodeIds.length>0&&(0,re.jsx)(u.u,{label:"Return to main graph",children:(0,re.jsx)(h.IconButton,{m:1,icon:(0,re.jsx)(y.DvO,{}),"aria-label":"Exit local mode",onClick:function(){return I((function(e){return dr(dr({},e),{},{nodeIds:[]})}))},variant:"subtle"})}),(0,re.jsx)(u.u,{label:Me?"Close Desk":"Open Desk",children:(0,re.jsx)(h.IconButton,{m:1,icon:(0,re.jsx)(C.IGV,{}),"aria-label":"Close desk view",variant:"subtle",onClick:Me?_e:Ve})}),(0,re.jsx)(u.u,{label:Ze?"Close sidebar":"Open sidebar",children:(0,re.jsx)(h.IconButton,{m:1,icon:(0,re.jsx)(C.iBV,{}),"aria-label":"Close file-viewer",variant:"subtle",onClick:Ze?We:He})})]})})})}),(0,re.jsx)(d.Box,{position:"relative",zIndex:4,children:(0,re.jsx)(Ht,{isOpenSidebar:Ze,onOpenSidebar:He,onCloseSidebar:We,previewNode:Fe,setPreviewNode:Ie,canUndo:De,canRedo:Le,previousPreviewNode:Pe,nextPreviewNode:Be,resetPreviewNode:Ne,setSidebarHighlightedNode:Ee,openContextMenu:Ct,scope:S,setScope:I,windowWidth:ut,tagColors:g,setTagColors:f,filter:A,setFilter:M,macros:Je.katexMacros,attachDir:Je.attachDir||"",useInheritance:Je.useInheritance||!1,nodeById:Ue.current,linksByNodeId:qe.current,nodeByCite:Xe.current})}),(0,re.jsx)(d.Box,{position:"relative",zIndex:4,children:(0,re.jsx)($t,{isOpenDesk:Me,onOpenDesk:Ve,onCloseDesk:_e,selectedItems:ye,setSelectedItems:Ce,setPreviewNode:Ie,setSidebarHighlightedNode:Ee,openContextMenu:Ct,scope:S,setScope:I,windowWidth:ut,tagColors:g,setTagColors:f,macros:Je.katexMacros,attachDir:Je.attachDir||"",useInheritance:Je.useInheritance||!1,nodeById:Ue.current,linksByNodeId:qe.current,nodeByCite:Xe.current,webSocket:st.current})}),mt.isOpen&&(0,re.jsx)("div",{ref:gt,children:(0,re.jsx)(fe,{scope:S,target:pt,background:!1,coordinates:vt,handleLocal:wt,menuClose:mt.onClose.bind(mt),webSocket:st.current,setPreviewNode:Ie,setFilter:M,filter:A,setTagColors:f,tagColors:g})})]})})})}var xr=function(e){var t=e.graphRef,n=e.physics,s=e.graphData,a=e.threeDim,u=e.linksByNodeId,h=e.filter,p=e.emacsNodeId,j=e.nodeById,b=e.visuals,y=e.behavior,C=e.mouse,w=e.scope,O=e.local,S=(e.setScope,e.webSocket),I=e.tagColors,N=e.linktagColors,P=e.setPreviewNode,B=e.sidebarHighlightedNode,D=e.windowWidth,F=e.windowHeight,T=(e.setContextMenuTarget,e.openContextMenu),z=e.contextMenu,E=e.handleLocal,R=e.variables,Z=e.clusterRef,H=e.coloring,A=R.dailyDir,M=(R.roamDir,(0,v.useState)(null)),V=M[0],_=M[1],q=(0,g.Fg)(),X=(0,v.useContext)(nt.N).emacsTheme,Q=function(e,t,n){switch(e){case C.preview:P(t);break;case C.local:E(t,y.localSame);break;case C.follow:U(t,S);break;case C.context:T(t,n)}},G=(0,v.useRef)(null);(0,v.useEffect)((function(){p&&_(j[p])}),[p]);var K=(0,v.useRef)({}),$=(0,v.useRef)({}),J=(0,v.useMemo)((function(){var e;$.current={};var t=null===s||void 0===s||null===(e=s.nodes)||void 0===e?void 0:e.filter((function(e){var t,n,r,o,l=e;return h.dirsBlocklist.length&&h.dirsBlocklist.some((function(e){var t;return null===l||void 0===l||null===(t=l.file)||void 0===t?void 0:t.includes(e)}))||h.dirsAllowlist.length>0&&!h.dirsAllowlist.some((function(e){var t;return null===l||void 0===l||null===(t=l.file)||void 0===t?void 0:t.includes(e)}))||h.tagsBlacklist.length&&h.tagsBlacklist.some((function(e){var t;return(null===l||void 0===l||null===(t=l.tags)||void 0===t?void 0:t.indexOf(e))>-1}))||h.tagsWhitelist.length>0&&!h.tagsWhitelist.some((function(e){var t;return(null===l||void 0===l||null===(t=l.tags)||void 0===t?void 0:t.indexOf(e))>-1}))||h.filelessCites&&null!==l&&void 0!==l&&null!==(t=l.properties)&&void 0!==t&&t.FILELESS||null!==h&&void 0!==h&&h.bad&&null!==l&&void 0!==l&&null!==(n=l.properties)&&void 0!==n&&n.bad||h.dailies&&A&&null!==(r=l.file)&&void 0!==r&&r.includes(A)?($.current=dr(dr({},$.current),{},(0,i.Z)({},l.id,l)),!1):!h.noter||null===(o=l.properties)||void 0===o||!o.NOTER_PAGE||($.current=dr(dr({},$.current),{},(0,i.Z)({},l.id,l)),!1)})).filter((function(e){var t,n=(null!==(t=u[null===e||void 0===e?void 0:e.id])&&void 0!==t?t:[]).filter((function(e){return!$.current[e.source]&&!$.current[e.target]}));return!h.orphans||(h.parent?0!==n.length:0!==n.length&&n.some((function(e){return!["parent","heading"].includes(e.type)})))})),n=t.map((function(e){return e.id})),r=s.links.filter((function(e){var t,r,o=yt(e),i=(0,l.Z)(o,2),s=i[0],c=i[1];if(!n.includes(s)||!n.includes(c))return!1;var a=e;return!(h.linktagsBlacklist.length>0&&null!==a&&void 0!==a&&null!==(t=a.properties)&&void 0!==t&&t.tag&&h.linktagsBlacklist.indexOf(a.properties.tag)>-1)&&(!(h.linktagsWhitelist.length>0&&!(null!==a&&void 0!==a&&null!==(r=a.properties)&&void 0!==r&&r.tag&&h.linktagsWhitelist.indexOf(a.properties.tag)>-1))&&(h.parent?"heading"===h.parent?"parent"!==a.type:"heading"!==a.type:!["parent","heading"].includes(a.type)))}));K.current=r.reduce((function(e,t){var n,r,s,c=t,a=yt(c),d=(0,l.Z)(a,2),u=d[0],h=d[1];return dr(dr({},e),{},(s={},(0,i.Z)(s,u,[].concat((0,o.Z)(null!==(n=e[u])&&void 0!==n?n:[]),[c])),(0,i.Z)(s,h,[].concat((0,o.Z)(null!==(r=e[h])&&void 0!==r?r:[]),[c])),s))}),{});var c=r.map((function(e){var t=yt(e),n=(0,l.Z)(t,2);return{target:n[0],source:n[1],weight:"cite"===e.type?1:2}}));if("community"===H.method){var a=m()().nodes(n).edges(c);Z.current=a()}return{nodes:t,links:r}}),[h,s,H.method]),Y=(0,v.useState)({nodes:[],links:[]}),ee=Y[0],te=Y[1];(0,v.useEffect)((function(){if(w.nodeIds.length){var e=w.nodeIds.length>1?ee.nodes.filter((function(e){return!w.excludedNodeIds.includes(e.id)})):[],t=e.map((function(e){return e.id})),n=function(e){var t=e.ids,n=e.excludedIds,r=e.n,o=e.linksByNodeId,i=[t[0]],s=[],c=[t[0]];return Array.from({length:r},(function(){i.forEach((function(e){var t;(null!==(t=o[e])&&void 0!==t?t:[]).forEach((function(e){var t=yt(e),r=(0,l.Z)(t,2),o=r[0],i=r[1];n.some((function(e){return[o,i].includes(e)}))||(c.includes(o)?c.includes(i)||s.push(i):s.push(o))}))})),i=s,s.forEach((function(e){return e&&c.push(e)})),s=[]})),c}({ids:w.nodeIds,excludedIds:w.excludedNodeIds,n:O.neighbors,linksByNodeId:K.current}),r=J.nodes.filter((function(r){var o;return e.length?!t.includes(r.id)&&(null!==(o=K.current[r.id])&&void 0!==o?o:[]).some((function(e){var t=yt(e),n=(0,l.Z)(t,2),r=n[0],o=n[1];return!w.excludedNodeIds.includes(r)&&!w.excludedNodeIds.includes(o)&&(w.nodeIds.includes(r)||w.nodeIds.includes(o))})):n.includes(r.id)})).map((function(e){return dr(dr({},e),{},{x:0,y:0,vy:0,vx:0})})),i=[].concat((0,o.Z)(e),(0,o.Z)(r)),s=i.map((function(e){return e.id})),c=(w.nodeIds.length>1?ee.links:[]).filter((function(e){w.excludedNodeIds.some((function(t){return yt(e).includes(t)}))}));console.log(J.links);var a=J.links.filter((function(e){var n=yt(e),r=(0,l.Z)(n,2),o=r[0],i=r[1];return!(c.length&&t.includes(i)&&t.includes(o))&&(s.includes(o)&&s.includes(i))})).map((function(e){var t=yt(e),n=(0,l.Z)(t,2);return{source:n[0],target:n[1],properties:null===e||void 0===e?void 0:e.properties}})),d=[].concat((0,o.Z)(c),(0,o.Z)(a));console.log(a),te({nodes:i,links:d})}}),[O.neighbors,h,w,w.excludedNodeIds,w.nodeIds,s,J.links,J.nodes]),(0,v.useEffect)((function(){(0,r.Z)(c().mark((function e(){var r,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.current,e.next=3,ur;case 3:o=e.sent,!n.gravityOn||w.nodeIds.length&&!n.gravityLocal?(r.d3Force("x",null),r.d3Force("y",null),a&&r.d3Force("z",null)):(r.d3Force("x",o.forceX().strength(n.gravity)),r.d3Force("y",o.forceY().strength(n.gravity)),a&&r.d3Force("z",o.forceZ().strength(n.gravity))),n.centering?r.d3Force("center",o.forceCenter().strength(n.centeringStrength)):r.d3Force("center",null),n.linkStrength&&r.d3Force("link").strength(n.linkStrength),n.linkIts&&r.d3Force("link").iterations(n.linkIts),n.charge&&r.d3Force("charge").strength(n.charge),r.d3Force("collide",n.collision?o.forceCollide().radius(n.collisionStrength):null);case 10:case"end":return e.stop()}}),e)})))()}),[n,a,w]),(0,v.useEffect)((function(){var e;null===(e=t.current)||void 0===e||e.d3ReheatSimulation()}),[n,w.nodeIds.length]);var ne=(0,v.useRef)(0),oe=(0,v.useState)(1),ie=oe[0],le=oe[1],se=(0,f._7)((function(e){return le(e)}),{duration:b.animationSpeed,algorithm:L[b.algorithmName]}),ce=(0,l.Z)(se,2),ae=ce[0],de=ce[1],ue=(0,f._7)((function(e){return le(Math.min(ie,-1*(e-1)))}),{duration:b.animationSpeed,algorithm:L[b.algorithmName]}),he=(0,l.Z)(ue,2),ge=he[0],fe=he[1],pe=(0,v.useMemo)((function(){var e;if(!G.current)return{};var t=K.current[G.current.id];return t?Object.fromEntries([null===(e=G.current)||void 0===e?void 0:e.id].concat((0,o.Z)(t.flatMap((function(e){return[e.source,e.target]})))).map((function(e){return[e,{}]}))):{}}),[G.current,K.current]);(0,v.useEffect)((function(){null!==B&&void 0!==B&&B.id?_(B):_(null)}),[B]);var xe=(0,v.useRef)(null);(0,v.useEffect)((function(){if(G.current=V,V&&(xe.current=V),!b.highlightAnim)return le(V?1:0);V?ae():(de(),ie>.5?ge():le(0))}),[V]);var je=(0,v.useMemo)((function(){return Object.fromEntries(W.map((function(e){var t=st(e,q),n=W.map((function(e){return[e,x.Z(t,st(e,q))]}));return[e,Object.fromEntries(n)]})))}),[X]),ve=(0,v.useMemo)((function(){var e,t,n,r=null!==(e=K.current[null===(t=xe.current)||void 0===t?void 0:t.id])&&void 0!==e?e:[];return Object.fromEntries([null===(n=xe.current)||void 0===n?void 0:n.id].concat((0,o.Z)(r.flatMap((function(e){return yt(e)})))).map((function(e){return[e,{}]})))}),[JSON.stringify(V),xe.current,K.current]),be=(0,v.useMemo)((function(){return st(b.labelTextColor,q)}),[b.labelTextColor,X]),me=(0,v.useMemo)((function(){return st(b.labelBackgroundColor,q)}),[b.labelBackgroundColor,X]),ye=(0,v.useState)(!1),Ce=ye[0],we=ye[1],ke=(0,v.useRef)(1),Oe={graphData:w.nodeIds.length?ee:J,width:D,height:F,backgroundColor:st(b.backgroundColor,q),warmupTicks:1===w.nodeIds.length?100:w.nodeIds.length>1?20:0,onZoom:function(e){var t=e.k;e.x,e.y;return ke.current=t},nodeColor:function(e){return function(e){var t,n,r=e.node,o=e.theme,i=e.highlightedNodes,l=e.previouslyHighlightedNodes,s=e.visuals,c=e.tagColors,a=e.highlightColors,d=e.opacity,u=e.emacsNodeId,h=e.linksByNodeId,g=e.cluster,f=e.coloring,p=i[r.id]||l[r.id];if(s.emacsNodeColor&&r.id===u)return st(s.emacsNodeColor,o);if(c&&null!==r&&void 0!==r&&r.tags.some((function(e){return c[e]}))){var x=c[null===r||void 0===r?void 0:r.tags.filter((function(e){return c[e]}))[0]];return p?a[x][x](s.highlightFade*d):a[x][s.backgroundColor](s.highlightFade*d)}return s.citeNodeColor&&null!==r&&void 0!==r&&null!==(t=r.properties)&&void 0!==t&&t.ROAM_REFS&&null!==r&&void 0!==r&&null!==(n=r.properties)&&void 0!==n&&n.FILELESS?p?st(s.citeNodeColor,o):a[s.citeNodeColor][s.backgroundColor](s.highlightFade*d):s.refNodeColor&&r.properties.ROAM_REFS?p?st(s.refNodeColor,o):a[s.refNodeColor][s.backgroundColor](s.highlightFade*d):p?s.nodeHighlight?a[lr({id:r.id,cluster:g,coloring:f,linksByNodeId:h,visuals:s})][s.nodeHighlight](d):st(lr({id:r.id,cluster:g,coloring:f,linksByNodeId:h,visuals:s}),o):a[lr({id:r.id,cluster:g,coloring:f,linksByNodeId:h,visuals:s})][s.backgroundColor](s.highlightFade*d)}({node:e,theme:q,visuals:b,cluster:Z.current,coloring:H,emacsNodeId:p,highlightColors:je,highlightedNodes:pe,previouslyHighlightedNodes:ve,linksByNodeId:K.current,opacity:ie,tagColors:I})},nodeRelSize:b.nodeRel,nodeVal:function(e){return rr({node:e,highlightedNodes:pe,linksByNodeId:K.current,opacity:ie,previouslyHighlightedNodes:ve,visuals:b})/Math.pow(ke.current,b.nodeZoomSize)},nodeCanvasObject:function(e,t,n){ir(dr({nodeRel:b.nodeRel,filteredLinksByNodeId:K.current,lastHoverNode:xe.current},{node:e,ctx:t,globalScale:n,highlightedNodes:pe,previouslyHighlightedNodes:ve,visuals:b,opacity:ie,labelTextColor:be,labelBackgroundColor:me,hoverNode:V}))},nodeCanvasObjectMode:function(){return"after"},linkDirectionalParticles:b.particles?b.particlesNumber:void 0,linkDirectionalArrowLength:b.arrows?b.arrowsLength:void 0,linkDirectionalArrowRelPos:b.arrowsPos,linkDirectionalArrowColor:b.arrowsColor?function(){return st(b.arrowsColor,q)}:void 0,linkColor:function(e){var t,n,r,o="object"===typeof e.source?e.source.id:e.source,i="object"===typeof e.target?e.target.id:e.target,l=sr(e,G.current),s=sr(e,xe.current),c=l||s,a=e;if(b.refLinkColor&&"ref"===a.type)return c&&(b.refLinkHighlightColor||b.linkHighlight)?je[b.refLinkColor][b.refLinkHighlightColor||b.linkHighlight](ie):je[b.refLinkColor][b.backgroundColor](b.highlightFade*ie);if(b.citeLinkColor&&null!==(t=a.type)&&void 0!==t&&t.includes("cite"))return c&&(b.citeLinkHighlightColor||b.linkHighlight)?je[b.citeLinkColor][b.citeLinkHighlightColor||b.linkHighlight](ie):je[b.citeLinkColor][b.backgroundColor](b.highlightFade*ie);if(N&&null!==a&&void 0!==a&&null!==(n=a.properties)&&void 0!==n&&n.tag&&(null===a||void 0===a||null===(r=a.properties)||void 0===r?void 0:r.tag)in N){var d,u=N[null===a||void 0===a||null===(d=a.properties)||void 0===d?void 0:d.tag];return c?je[u][u](b.highlightFade*ie):je[u][b.backgroundColor](b.highlightFade*ie)}return function(e){var t=e.sourceId,n=e.targetId,r=e.needsHighlighting,o=e.theme,i=e.visuals,l=e.highlightColors,s=e.opacity,c=e.linksByNodeId,a=e.coloring,d=e.cluster;if(!i.linkHighlight&&!i.linkColorScheme&&!r){var u=cr({sourceId:t,targetId:n,linksByNodeId:c,visuals:i,coloring:a,cluster:d});return st(u,o)}if(!r&&!i.linkColorScheme)return l[cr({sourceId:t,targetId:n,linksByNodeId:c,visuals:i,coloring:a,cluster:d})][i.backgroundColor](i.highlightFade*s);if(!r)return l[i.linkColorScheme][i.backgroundColor](i.highlightFade*s);if(!i.linkHighlight&&!i.linkColorScheme){var h=cr({sourceId:t,targetId:n,linksByNodeId:c,visuals:i,coloring:a,cluster:d});return st(h,o)}return i.linkHighlight?i.linkColorScheme?l[i.linkColorScheme][i.linkHighlight](s):l[cr({sourceId:t,targetId:n,linksByNodeId:c,visuals:i,coloring:a,cluster:d})][i.linkHighlight](s):st(i.linkColorScheme,o)}({sourceId:o,targetId:i,needsHighlighting:c,theme:q,cluster:Z.current,coloring:H,highlightColors:je,linksByNodeId:K.current,opacity:ie,visuals:b})},linkWidth:function(e){if(1===b.highlightLinkSize)return b.linkWidth;var t=sr(e,G.current),n=sr(e,xe.current);return t||n?b.linkWidth*(1+ie*(b.highlightLinkSize-1)):b.linkWidth},linkDirectionalParticleWidth:b.particlesWidth,d3AlphaDecay:n.alphaDecay,d3AlphaMin:n.alphaMin,d3VelocityDecay:n.velocityDecay,onNodeClick:function(e,t){var n=e,r=t.timeStamp-ne.current<200;if(ne.current=t.timeStamp,r)return Q("double",n,t);var o=ne.current;return setTimeout((function(){if(ne.current===o)return Q("click",n,t)}),200)},onNodeHover:function(e){b.highlight&&(Ce||(V||(fe(),le(0)),_(e)))},onNodeRightClick:function(e,t){Q("right",e,t)},onNodeDrag:function(e){_(e),we(!0)},onNodeDragEnd:function(e){_(null),we(!1),e.fx=e.x,e.fy=e.y}};return(0,re.jsx)(d.Box,{overflow:"hidden",onClick:z.onClose,children:a?(0,re.jsx)(gr,dr(dr({ref:t},Oe),{},{nodeThreeObjectExtend:!0,nodeOpacity:b.nodeOpacity,nodeResolution:b.nodeResolution,linkOpacity:b.linkOpacity,nodeThreeObject:function(e){if(b.labels&&(!(b.labels<3)||pe[e.id])){var t=new k.Z(e.title.substring(0,40));return t.color=st(b.labelTextColor,q),t.backgroundColor=st(b.labelBackgroundColor,q),t.padding=2,t.textHeight=8,t}}})):(0,re.jsx)(hr,dr(dr({ref:t},Oe),{},{linkLineDash:function(e){var t,n=e;return b.citeDashes&&null!==(t=n.type)&&void 0!==t&&t.includes("cite")?[b.citeDashLength,b.citeGapLength]:b.refDashes&&"ref"==n.type?[b.refDashLength,b.refGapLength]:null}}))})}},45301:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(15323)}])}},function(e){e.O(0,[774,737,876,228,866,13,874,573,446,54,888,179],(function(){return t=45301,e(e.s=t);var t}));var t=e.O();_N_E=t}]);